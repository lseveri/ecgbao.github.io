
 <!DOCTYPE HTML>
<html lang="zh-Hans">
<head>
  <meta charset="UTF-8">
  
    <title>跳跳魔王的博客</title>
    <meta name="viewport" content="width=device-width, initial-scale=1,user-scalable=no">
    
    <meta name="author" content="跳跳魔王">
    

    
    <meta property="og:type" content="website">
<meta property="og:title" content="跳跳魔王的博客">
<meta property="og:url" content="http://yoursite.com/index.html">
<meta property="og:site_name" content="跳跳魔王的博客">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="跳跳魔王的博客">

    
    <link rel="alternative" href="/atom.xml" title="跳跳魔王的博客" type="application/atom+xml">
    
    
    <link rel="icon" href="/img/favicon.ico">
    
    
    <link rel="apple-touch-icon" href="/img/jacman.jpg">
    <link rel="apple-touch-icon-precomposed" href="/img/jacman.jpg">
    
    <link rel="stylesheet" href="/css/style.css">
</head>

  <body>
    <header>
      
<div>
		
			<div id="textlogo">
				<h1 class="site-name"><a href="/" title="跳跳魔王的博客">跳跳魔王的博客</a></h1>
				<h2 class="blog-motto">每天进步一点点</h2>
			</div>
			<div class="navbar"><a class="navbutton navmobile" href="#" title="菜单">
			</a></div>
			<nav class="animated">
				<ul>
					<ul>
					 
						<li><a href="/">主页</a></li>
					
						<li><a href="/archives">归档</a></li>
					
						<li><a href="/about">关于</a></li>
					
					<li>
 					
					<form class="search" action="//google.com/search" method="get" accept-charset="utf-8">
						<label>Search</label>
						<input type="search" id="search" name="q" autocomplete="off" maxlength="20" placeholder="搜索" />
						<input type="hidden" name="q" value="site:yoursite.com">
					</form>
					
					</li>
				</ul>
			</nav>			
</div>
    </header>
    <div id="container">
      <div id="main">

   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2016/09/14/UIStackView-使用指南/" title="UIStackView 使用指南" itemprop="url">UIStackView 使用指南</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="跳跳魔王" target="_blank" itemprop="author">跳跳魔王</a>
		
  <p class="article-time">
    <time datetime="2016-09-14T07:14:17.000Z" itemprop="datePublished"> 发表于 2016-09-14</time>
    
  </p>
</header>
    <div class="article-content">
        
        <p></p>
<p><link rel="stylesheet" id="wpsqt-main-css" href="https://cdn3.raywenderlich.com/wp-content/plugins/wp-survey-and-quiz-tool/css/main.css?ver=4.5.2" type="text/css" media="all"></p>
<p><link rel="stylesheet" id="style-main-css" href="https://cdn4.raywenderlich.com/wp-content/themes/raywenderlich/style.min.css?ver=1471520796" type="text/css" media="all"></p>
<p><link rel="stylesheet" id="contact-form-7-css" href="https://cdn1.raywenderlich.com/wp-content/plugins/contact-form-7/includes/css/styles.css?ver=4.4.1" type="text/css" media="all"></p>
<p><link rel="stylesheet" id="swiftype-css" href="https://cdn4.raywenderlich.com/wp-content/plugins/swiftype-search/assets/autocomplete.css?ver=4.5.2" type="text/css" media="all"></p>
<p><link rel="stylesheet" id="videojs-plugin-css" href="https://cdn4.raywenderlich.com/wp-content/plugins/videojs-html5-video-player-for-wordpress/plugin-styles.css?ver=4.5.2" type="text/css" media="all"></p>
<p><link rel="stylesheet" id="videojs-css" href="//vjs.zencdn.net/4.5/video-js.css?ver=4.5.2" type="text/css" media="all"></p>
<p><link rel="stylesheet" id="wp-polls-css" href="https://www.raywenderlich.com/wp-content/plugins/wp-polls/polls-css.css?ver=2.73" type="text/css" media="all"></p>
<p><style id="wp-polls-inline-css" type="text/css"><br>.wp-polls .pollbar {<br>    margin: 1px;<br>    font-size: 6px;<br>    line-height: 8px;<br>    height: 8px;<br>    background-image: url(‘<a href="https://www.raywenderlich.com/wp-content/plugins/wp-polls/images/default/pollbg.gif">https://www.raywenderlich.com/wp-content/plugins/wp-polls/images/default/pollbg.gif</a>‘);<br>    border: 1px solid #c8c8c8;<br>}</p>
<p></style></p>
<script type="text/javascript" src="https://cdn5.raywenderlich.com/wp-includes/js/jquery/jquery.js?ver=1.12.3"></script>
<script type="text/javascript" src="https://cdn2.raywenderlich.com/wp-includes/js/jquery/jquery-migrate.min.js?ver=1.4.0"></script>
<script type="text/javascript" src="https://cdn4.raywenderlich.com/wp-content/plugins/wp-survey-and-quiz-tool/js/site.js?ver=4.5.2"></script>
<script type="text/javascript">
/* <![CDATA[ */
var swiftypeParams = {"engineKey":"omdTFN4ka9Dq1GBywQZq"};
/* ]]> */
</script>
<script type="text/javascript" src="https://cdn2.raywenderlich.com/wp-content/plugins/swiftype-search/assets/install_swiftype.min.js?ver=4.5.2"></script>
<script type="text/javascript" src="https://cdn3.raywenderlich.com/wp-content/themes/raywenderlich/scripts/global_combined.1.0.13.js?ver=4.5.2"></script>
<link rel="https://api.w.org/" href="https://www.raywenderlich.com/wp-json/">
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://www.raywenderlich.com/xmlrpc.php?rsd">
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://cdn5.raywenderlich.com/wp-includes/wlwmanifest.xml"> 
<meta name="generator" content="WordPress 4.5.2">
<link rel="shortlink" href="https://www.raywenderlich.com/?p=114552">
<link rel="alternate" type="application/json+oembed" href="https://www.raywenderlich.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.raywenderlich.com%2F114552%2Fuistackview-tutorial-introducing-stack-views">
<link rel="alternate" type="text/xml+oembed" href="https://www.raywenderlich.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.raywenderlich.com%2F114552%2Fuistackview-tutorial-introducing-stack-views&#038;format=xml">
<script type="text/javascript"><!--
function powerpress_pinw(pinw_url){window.open(pinw_url, 'PowerPressPlayer','toolbar=0,status=0,resizable=1,width=460,height=320');    return false;}
//-->
</script>

<p><br>        <link rel="stylesheet" href="https://cdn3.raywenderlich.com/wp-content/themes/raywenderlich/print.css?ver=090320131503" type="text/css" media="print"><br>        <link rel="profile" href="http://gmpg.org/xfn/11"><br>        <link rel="pingback" href="https://www.raywenderlich.com/xmlrpc.php"><br>        <script>var siteUrl = ‘<a href="https://cdn1.raywenderlich.com/wp-content/themes/raywenderlich">https://cdn1.raywenderlich.com/wp-content/themes/raywenderlich</a>‘</script></p>
<noscript><img height="1" width="1" alt="" style="display:none" src="https://www.facebook.com/tr?id=915433011818742&amp;ev=PixelInitialized"></noscript>


<div id="attachment_114189" style="width: 260px" class="wp-caption alignright"><img class="wp-image-114189 size-thumbnail" src="http://www.raywenderlich.com/wp-content/uploads/2015/09/iOS9_feast_UIStackView-250x250.jpg" alt="UIStackView Tutorial" width="250" height="250" srcset="https://cdn5.raywenderlich.com/wp-content/uploads/2015/09/iOS9_feast_UIStackView-250x250.jpg 250w, https://cdn5.raywenderlich.com/wp-content/uploads/2015/09/iOS9_feast_UIStackView-320x320.jpg 320w, https://cdn5.raywenderlich.com/wp-content/uploads/2015/09/iOS9_feast_UIStackView.jpg 500w, https://cdn5.raywenderlich.com/wp-content/uploads/2015/09/iOS9_feast_UIStackView-32x32.jpg 32w, https://cdn5.raywenderlich.com/wp-content/uploads/2015/09/iOS9_feast_UIStackView-64x64.jpg 64w, https://cdn5.raywenderlich.com/wp-content/uploads/2015/09/iOS9_feast_UIStackView-96x96.jpg 96w, https://cdn5.raywenderlich.com/wp-content/uploads/2015/09/iOS9_feast_UIStackView-128x128.jpg 128w" sizes="(max-width: 250px) 100vw, 250px"><p class="wp-caption-text">You&#8217;ll wonder how you ever survived before Stack Views!</p></div><br><p>我们都遇见过。 有个需要动态增删视图的新需求, 也需要重新定位临近视图。</p><br><p>你用什么方法? 你通过在故事板添加outlets来约束实现激活或者去激活这些视图? 或者用第三方库? 或者根据复杂度你会在代码实现。</p><br><p>现在介绍 <code>UIStackView</code>,  Stack 视图提供了一种方式去水平或者垂直布局一组视图。 通过配置一些简单的属性例如对齐方式,分布方式,间隔, 你可以在可用空间里定义包含的视图该如何调整布局。</p><br><br><h2>开始</h2><br><p>这篇 UIStackView 指导, 你会工作在一个叫<em>Vacation Spots</em>的程序. 这是个简单的程序，向你展示一系列的地方，让你远离当下一切。</p><br><p>现在先别打包行囊, 因为有一些问题你要用stack views来修复, 肯定比你用 Auto Layout简单的多。</p><br><p>先下载 <a href="http://www.raywenderlich.com/wp-content/uploads/2015/09/VacationSpots_Starter.zip" target="_blank" rel="external">开始工程</a> 在 <em>iPhone 6 Simulator</em>上运行。 你会看你一堆你可以去旅行的地方。</p><br><p><img class="aligncenter size-large wp-image-114555 bordered" src="http://www.raywenderlich.com/wp-content/uploads/2015/09/01-table-view-is-now-correct_750x1334-281x500.png" alt="01-table-view-is-now-correct_750x1334 bordered" width="281" height="500" srcset="https://cdn1.raywenderlich.com/wp-content/uploads/2015/09/01-table-view-is-now-correct_750x1334-281x500.png 281w, https://cdn1.raywenderlich.com/wp-content/uploads/2015/09/01-table-view-is-now-correct_750x1334-180x320.png 180w, https://cdn1.raywenderlich.com/wp-content/uploads/2015/09/01-table-view-is-now-correct_750x1334.png 750w" sizes="(max-width: 281px) 100vw, 281px"></p><br><p>点击 <em>London</em> 单元可以查看伦敦的详情。</p><br><p>扫一眼, 这个界面看起来还okay, 但是有一些问题。</p><br><ol start="1"><br><li>看一下位于界面底部的按钮行。 他们之间现在是固定间距的位置, 所以他们没有适配屏幕的宽度。 为了看到问题, <em>Command-left</em> 旋转屏幕看看。</li><br></ol><br><p><img class="aligncenter size-medium wp-image-114556 bordered" src="http://www.raywenderlich.com/wp-content/uploads/2015/09/02-issues-visible-in-landscape-view_1334x750-480x270.png" alt="02-issues-visible-in-landscape-view_1334x750" width="480" height="270" srcset="https://cdn3.raywenderlich.com/wp-content/uploads/2015/09/02-issues-visible-in-landscape-view_1334x750-480x270.png 480w, https://cdn3.raywenderlich.com/wp-content/uploads/2015/09/02-issues-visible-in-landscape-view_1334x750-700x394.png 700w, https://cdn3.raywenderlich.com/wp-content/uploads/2015/09/02-issues-visible-in-landscape-view_1334x750-266x151.png 266w, https://cdn3.raywenderlich.com/wp-content/uploads/2015/09/02-issues-visible-in-landscape-view_1334x750.png 1334w" sizes="(max-width: 480px) 100vw, 480px"></p><br><ol start="2"><br><li>点击靠近 <em>WEATHER</em> 的 <em>Hide</em> 按钮. 它可以隐藏文字, 可是它不能复位位于它下面的区域, 留下了一块空白。</li><br></ol><br><p><img class="aligncenter size-large wp-image-114557 bordered" src="http://www.raywenderlich.com/wp-content/uploads/2015/09/03-hide-weather-issue_750x1334-281x500.png" alt="03-hide-weather-issue_750x1334" width="281" height="500" srcset="https://cdn4.raywenderlich.com/wp-content/uploads/2015/09/03-hide-weather-issue_750x1334-281x500.png 281w, https://cdn4.raywenderlich.com/wp-content/uploads/2015/09/03-hide-weather-issue_750x1334-180x320.png 180w, https://cdn4.raywenderlich.com/wp-content/uploads/2015/09/03-hide-weather-issue_750x1334.png 750w" sizes="(max-width: 281px) 100vw, 281px"></p><br><ol start="3"><br><li>区域顺序可以调整。 <em>what to see</em> 区域刚好位于 <em>why visit</em> 下方可能更合逻辑, 而是不是有个 <em>weather</em> 在两者中间。</li><br><li>横屏的时候,底面的按钮组太靠近页面边界了。 减少不同区域的间距可能会比较好 – 仅在横屏模式下。</li><br></ol><br><p>既然有了改进的想法, 是时候研究工程了。</p><br><p>打开 <em>Main.storyboard</em> 看一下 <em>Spot Info View Controller</em> scene。 有一些颜色在你的stack view。</p><br><p><img class="aligncenter size-large wp-image-114558 bordered" src="http://www.raywenderlich.com/wp-content/uploads/2015/09/04-colorful-scene-in-storyboard_504x636-396x500.png" alt="04-colorful-scene-in-storyboard_504x636" width="396" height="500" srcset="https://cdn1.raywenderlich.com/wp-content/uploads/2015/09/04-colorful-scene-in-storyboard_504x636-396x500.png 396w, https://cdn1.raywenderlich.com/wp-content/uploads/2015/09/04-colorful-scene-in-storyboard_504x636-254x320.png 254w, https://cdn1.raywenderlich.com/wp-content/uploads/2015/09/04-colorful-scene-in-storyboard_504x636.png 504w" sizes="(max-width: 396px) 100vw, 396px"></p><br><p>这些标签和按钮设置了太多的背景色,在运行时将要被清除。 在这个故事板, 他们只是用来视觉展示如何通过改变属性值影响内嵌视图的frame。</p><br><p>你现在不需要做这些, 但是如果你想在运行时看到这些背景色,可以在 <code>SpotInfoViewController</code>里放开<code>viewDidLoad()</code>下面的代码。</p><br><br><div class="wp_codebox"><table><tr id="p1145521"><td class="code" id="p114552code1"><pre class="swift" style="font-family:monospace;"><span style="color: #11740a; font-style: italic;">// Clear background colors from labels and buttons</span><br><span style="color: #a61390;">for</span> view <span style="color: #a61390;">in</span> backgroundColoredViews <span style="color: #002200;">&#123;</span><br>  view.backgroundColor <span style="color: #002200;">=</span> <span style="color: #400080;">UIColor</span>.clearColor<span style="color: #002200;">&#40;</span><span style="color: #002200;">&#41;</span><br><span style="color: #002200;">&#125;</span></pre></td></tr></table></div>

<p>Also, any outlet-connected labels have placeholder text that&#8217;s set to the name of the outlet variable to which they are connected. This makes it a bit easier to tell which labels will have their text updated at runtime. For example, the label with text <em>&lt;</em><em>whyVisitLabel&gt;</em> is connected to:</p>

<div class="wp_codebox"><table><tr id="p1145522"><td class="code" id="p114552code2"><pre class="swift" style="font-family:monospace;">@IBOutlet weak <span style="color: #a61390;">var</span> whyVisitLabel<span style="color: #002200;">:</span> <span style="color: #400080;">UILabel</span><span style="color: #002200;">!</span></pre></td></tr></table></div>

<p>Another thing to note is that the scenes in the storyboard are not the default 600 x 600 squares that you get when using size classes.</p><br><p>Size classes are still enabled, but the size of the initial Navigation Controller has been set to <em>iPhone 4-inch</em> under the <em>Simulated Metrics</em> section in the <em>Attributes inspector</em>. This just makes it a bit easier to work with the storyboard; the simulated metrics property has no effect at runtime — the view will resize for different devices.</p><br><p><img class="aligncenter size-full wp-image-114559 bordered" src="http://www.raywenderlich.com/wp-content/uploads/2015/09/05-simulated-metrics-iphone-4-inch_639x173.png" alt="05-simulated-metrics-iphone-4-inch_639x173" width="639" height="173" srcset="https://cdn4.raywenderlich.com/wp-content/uploads/2015/09/05-simulated-metrics-iphone-4-inch_639x173.png 639w, https://cdn4.raywenderlich.com/wp-content/uploads/2015/09/05-simulated-metrics-iphone-4-inch_639x173-480x130.png 480w" sizes="(max-width: 639px) 100vw, 639px"></p><br><h2>Your first stack view</h2><br><p>The first thing you&#8217;ll fix by using a stack view is the spacing between the bottom row of buttons. A stack view can distribute its views along its axis in various ways, and one of the ways is with an equal amount of spacing between each view.</p><br><p>Fortunately, embedding existing views into a new stack view is not rocket science. First, select all of the buttons at the bottom of the <em>Spot Info View Controller</em> scene by <em>clicking</em> on one, then <em>Command-click</em> on the other two:</p><br><p><img class="aligncenter size-full wp-image-114560 bordered" src="http://www.raywenderlich.com/wp-content/uploads/2015/09/06-select-bottom-row-of-buttons_420x80.png" alt="06-select-bottom-row-of-buttons_420x80" width="420" height="80"></p><br><p>If the outline view isn&#8217;t already open, go ahead and open it by using the <em>Show Document Outline</em> button at the bottom left of the storyboard canvas:</p><br><p><img class="aligncenter size-full wp-image-114561 bordered" src="http://www.raywenderlich.com/wp-content/uploads/2015/09/07-document-outline-button_120x40.png" alt="07-document-outline-button_120x40" width="120" height="40"></p><br><p>Verify that all 3 buttons are selected by checking them in the outline view:</p><br><p><img class="aligncenter size-full wp-image-114562 bordered" src="http://www.raywenderlich.com/wp-content/uploads/2015/09/08-verify-button-selection_360x90.png" alt="08-verify-button-selection_360x90" width="360" height="90"></p><br><p>In case they aren&#8217;t all selected, you can also <em>Command-click</em> on each button in the outline view to select them.</p><br><p>Once selected, click on the new <em>Stack</em> button in the Auto Layout toolbar at the bottom right of the storyboard canvas:</p><br><p><img class="aligncenter size-full wp-image-114563 bordered" src="http://www.raywenderlich.com/wp-content/uploads/2015/09/09-stack_button_outlined_148x52.png" alt="09-stack_button_outlined_148x52" width="148" height="52"></p><br><p>The buttons will become embedded in a new stack view:</p><br><p><img class="aligncenter size-full wp-image-114564 bordered" src="http://www.raywenderlich.com/wp-content/uploads/2015/09/10-bottom-row-is-now-in-stack-view_640x100.png" alt="10-bottom-row-is-now-in-stack-view_640x100" width="640" height="100" srcset="https://cdn5.raywenderlich.com/wp-content/uploads/2015/09/10-bottom-row-is-now-in-stack-view_640x100.png 640w, https://cdn5.raywenderlich.com/wp-content/uploads/2015/09/10-bottom-row-is-now-in-stack-view_640x100-480x75.png 480w" sizes="(max-width: 640px) 100vw, 640px"></p><br><p>The buttons are now flush with each other – you&#8217;ll that fix shortly.</p><br><p>While the stack view takes care of positioning the buttons, you still need to add Auto Layout constraints to position the stack view itself.</p><br><p>When you embed a view in a stack view, any constraints to other views are removed. For example, prior to embedding the buttons in a stack view, the top of the <em>Submit Rating</em> button had a vertical spacing constraint connecting it to the bottom of the <em>Rating:</em> label:</p><br><p><img class="aligncenter size-full wp-image-114565 bordered" src="http://www.raywenderlich.com/wp-content/uploads/2015/09/11-prior-constraint_420x90.png" alt="11-prior-constraint_420x90" width="420" height="90"></p><br><p>Click on the <em>Submit Rating</em> button to see that it no longer has any constraints attached to it:</p><br><p><img class="aligncenter size-full wp-image-114566 bordered" src="http://www.raywenderlich.com/wp-content/uploads/2015/09/12-no-more-constraints_400x80.png" alt="12-no-more-constraints_400x80" width="400" height="80"></p><br><p>Another way to verify that the constraints are gone is by looking at the <em>Size inspector</em> (⌥⌘5):</p><br><p><img class="aligncenter size-full wp-image-114567 bordered" src="http://www.raywenderlich.com/wp-content/uploads/2015/09/13-check-size-inspector_640x80.png" alt="13-check-size-inspector_640x80" width="640" height="80" srcset="https://cdn4.raywenderlich.com/wp-content/uploads/2015/09/13-check-size-inspector_640x80.png 640w, https://cdn4.raywenderlich.com/wp-content/uploads/2015/09/13-check-size-inspector_640x80-480x60.png 480w" sizes="(max-width: 640px) 100vw, 640px"></p><br><p>In order to add constraints to position the stack view itself, you&#8217;ll first need to select it. Selecting a stack view in the storyboard can get tricky if its views completely fill the stack view.</p><br><p>One simple way is to select the stack view in the outline view:</p><br><p><img class="aligncenter size-full wp-image-114568 bordered" src="http://www.raywenderlich.com/wp-content/uploads/2015/09/14-stack-view-document-outline-selection_660x80.png" alt="14-stack-view-document-outline-selection_660x80" width="660" height="80" srcset="https://cdn2.raywenderlich.com/wp-content/uploads/2015/09/14-stack-view-document-outline-selection_660x80.png 660w, https://cdn2.raywenderlich.com/wp-content/uploads/2015/09/14-stack-view-document-outline-selection_660x80-480x58.png 480w" sizes="(max-width: 660px) 100vw, 660px"></p><br><p>Another trick is to hold <em>Shift</em> and <em>Right-click</em> on any of the views in the stack view, or <em>Control-Shift-click</em> if you&#8217;re using a trackpad. You&#8217;ll get a context menu that shows the view hierarchy at the location you clicked, and you simply select the stack view by clicking on it in the menu.</p><br><p>For now, select the stack view using the <em>Shift-Right-click</em> method:</p><br><p><img class="aligncenter size-full wp-image-114569 bordered" src="http://www.raywenderlich.com/wp-content/uploads/2015/09/15-select-stack-view-in-view-hierarchy-menu_400x280.png" alt="15-select-stack-view-in-view-hierarchy-menu_400x280" width="400" height="280"></p><br><p>Now, click the <em>Pin</em> button on the Auto Layout toolbar to add constraints to it:</p><br><p><img class="aligncenter size-full wp-image-114570 bordered" src="http://www.raywenderlich.com/wp-content/uploads/2015/09/16-pin-button_142x57.png" alt="16-pin-button_142x57" width="142" height="57"></p><br><p>First add a check to <em>Constrain to margins</em>. Then add the following constraints to the edges of your stack view:</p>

<div class="wp_codebox"><table><tr id="p1145523"><td class="code" id="p114552code3"><pre class="bash" style="font-family:monospace;">Top: <span style="color: #000000;">20</span>, Leading: <span style="color: #000000;">0</span>, Trailing: <span style="color: #000000;">0</span>, Bottom: <span style="color: #000000;">0</span></pre></td></tr></table></div>

<p>Double-check the numbers for the top, leading, trailing, and bottom constraints and make sure that the <em>I-beams</em> are selected. Then click on <em>Add 4 Constraints</em>:</p><br><p><img class="aligncenter size-full wp-image-114571 bordered" src="http://www.raywenderlich.com/wp-content/uploads/2015/09/17-bottom-stack-view-constraints_264x364.png" alt="17-bottom-stack-view-constraints_264x364" width="264" height="364" srcset="https://cdn4.raywenderlich.com/wp-content/uploads/2015/09/17-bottom-stack-view-constraints_264x364.png 264w, https://cdn4.raywenderlich.com/wp-content/uploads/2015/09/17-bottom-stack-view-constraints_264x364-232x320.png 232w" sizes="(max-width: 264px) 100vw, 264px"></p><br><p>Now the stack view is the correct size, but it has stretched the first button to fill in any extra space:</p><br><p><img class="aligncenter size-full wp-image-114572 bordered" src="http://www.raywenderlich.com/wp-content/uploads/2015/09/18-first-button-is-stretched_400x80.png" alt="18-first-button-is-stretched_400x80" width="400" height="80"></p><br><p>The property that determines how a stack view lays out its views along its axis is its <code>distribution</code> property. Currently, it&#8217;s set to <code>Fill</code>, which means the contained views will completely fill the stack view along its axis. To accomplish this, the stack view will only expand one of its views to fill that extra space; specifically, it expands the view with the lowest horizontal content hugging priority, or if all of the priorities are equal, it expands the first view.</p><br><p>However, you&#8217;re not looking for the buttons to fill the stack view completely – you want them to be equally spaced.</p><br><p>Make sure the stack view is still selected, and go to the <em>Attributes inspector</em>. Change the <em>Distribution</em> from <em>Fill</em> to <em>Equal Spacing</em>:</p><br><p><img class="aligncenter size-full wp-image-114573 bordered" src="http://www.raywenderlich.com/wp-content/uploads/2015/09/19-change-distribution-to-equal-spacing_640x148.png" alt="19-change-distribution-to-equal-spacing_640x148" width="640" height="148" srcset="https://cdn2.raywenderlich.com/wp-content/uploads/2015/09/19-change-distribution-to-equal-spacing_640x148.png 640w, https://cdn2.raywenderlich.com/wp-content/uploads/2015/09/19-change-distribution-to-equal-spacing_640x148-480x111.png 480w" sizes="(max-width: 640px) 100vw, 640px"></p><br><p>Now build and run, tap on any cell, and rotate the simulator (⌘→). You&#8217;ll see that the bottom buttons now space themselves equally!</p><br><p><img class="aligncenter size-medium wp-image-114574 bordered" src="http://www.raywenderlich.com/wp-content/uploads/2015/09/20-now-buttons-are-equally-spaced_1334x750-480x270.png" alt="20-now-buttons-are-equally-spaced_1334x750" width="480" height="270" srcset="https://cdn2.raywenderlich.com/wp-content/uploads/2015/09/20-now-buttons-are-equally-spaced_1334x750-480x270.png 480w, https://cdn2.raywenderlich.com/wp-content/uploads/2015/09/20-now-buttons-are-equally-spaced_1334x750-700x394.png 700w, https://cdn2.raywenderlich.com/wp-content/uploads/2015/09/20-now-buttons-are-equally-spaced_1334x750-266x151.png 266w, https://cdn2.raywenderlich.com/wp-content/uploads/2015/09/20-now-buttons-are-equally-spaced_1334x750.png 1334w" sizes="(max-width: 480px) 100vw, 480px"></p><br><p>In order to solve this problem without a stack view, you would have had to use spacer views, one between each pair of buttons. You&#8217;d have to add equal width constraints to all of the spacer views as well as lots of additional constraints to position the spacer views correctly.</p><br><p>It would have looked something like the following. For visibility in the screenshot, the spacer views have been given a light gray background:</p><br><p><img class="aligncenter size-full wp-image-114575 bordered" src="http://www.raywenderlich.com/wp-content/uploads/2015/09/21-alternate-solution-1_346x76.png" alt="21-alternate-solution-1_346x76" width="346" height="76"></p><br><p>This isn&#8217;t too much of an issue if you only have to do this once in the storyboard, but many views are dynamic. It&#8217;s not a straightforward task to add a new button or to hide or remove an existing button at runtime because of the adjacent spacer views and constraints.</p><br><p>In order to hide a view within a stack view, all you have to do is set the contained view&#8217;s <code>hidden</code> property to <code>true</code> and the stack view handles the rest. This is how you&#8217;ll fix the spacing under the <em>WEATHER</em> label when the user hides the text below it. You&#8217;ll do that a bit later in the tutorial once you&#8217;ve added the weather section labels into a stack view.</p><br><h2>Converting the sections</h2><br><p>You will convert all of the other sections in <code>SpotInfoViewController</code> to use stack views as well. This will enable you to easily complete the remaining tasks. You&#8217;ll convert the rating section next.</p><br><h3>Rating section</h3><br><p>Right above the stack view that you just created, select the <em>RATING</em> label and the stars label next to it:</p><br><p><img class="aligncenter wp-image-114576 size-full bordered" src="http://www.raywenderlich.com/wp-content/uploads/2015/09/22-select-rating-label-and-stars-label_640x74.png" alt="22-select-rating-label-and-stars-label_640x74" width="640" height="74" srcset="https://cdn2.raywenderlich.com/wp-content/uploads/2015/09/22-select-rating-label-and-stars-label_640x74.png 640w, https://cdn2.raywenderlich.com/wp-content/uploads/2015/09/22-select-rating-label-and-stars-label_640x74-480x56.png 480w" sizes="(max-width: 640px) 100vw, 640px"></p><br><p>Then click on the <em>Stack</em> button to embed them in a stack view:</p><br><p><img class="aligncenter size-full wp-image-114577 bordered" src="http://www.raywenderlich.com/wp-content/uploads/2015/09/23-after-clicking-stack-button_640x74.png" alt="23-after-clicking-stack-button_640x74" width="640" height="74" srcset="https://cdn4.raywenderlich.com/wp-content/uploads/2015/09/23-after-clicking-stack-button_640x74.png 640w, https://cdn4.raywenderlich.com/wp-content/uploads/2015/09/23-after-clicking-stack-button_640x74-480x56.png 480w" sizes="(max-width: 640px) 100vw, 640px"></p><br><p>Now click on the <em>Pin</em> button. Place a checkmark in <em>Constrain to margins</em> and add the following <em>three</em> constraints:</p>

<div class="wp_codebox"><table><tr id="p1145524"><td class="code" id="p114552code4"><pre class="bash" style="font-family:monospace;">Top: <span style="color: #000000;">20</span>, Leading: <span style="color: #000000;">0</span>, Bottom: <span style="color: #000000;">20</span></pre></td></tr></table></div>

<p><img class="aligncenter size-full wp-image-114578 bordered" src="http://www.raywenderlich.com/wp-content/uploads/2015/09/24-add-second-stack-view-constraints_264x171.png" alt="24-add-second-stack-view-constraints_264x171" width="264" height="171"></p><br><p>Now go to the <em>Attributes inspector</em> and set the spacing to <em>8</em>:</p><br><p><img class="aligncenter size-full wp-image-114579 bordered" src="http://www.raywenderlich.com/wp-content/uploads/2015/09/25-set-spacing-to-8_259x87.png" alt="25-set-spacing-to-8_259x87" width="259" height="87"></p><br><p>It&#8217;s possible you may see a <i>Misplaced Views</i> warning and see something like this in which the stars label has stretched beyond the bounds of the view:</p><br><p><img class="aligncenter size-full wp-image-114580 bordered" src="http://www.raywenderlich.com/wp-content/uploads/2015/09/26-stars-label-weirdly-stretched_640x85.png" alt="26-stars-label-weirdly-stretched_640x85" width="640" height="85" srcset="https://cdn1.raywenderlich.com/wp-content/uploads/2015/09/26-stars-label-weirdly-stretched_640x85.png 640w, https://cdn1.raywenderlich.com/wp-content/uploads/2015/09/26-stars-label-weirdly-stretched_640x85-480x64.png 480w" sizes="(max-width: 640px) 100vw, 640px"></p><br><p>Sometimes Xcode may temporarily show a warning or position the stack view incorrectly, but the warning will disappear as you make other updates. You can usually safely ignore these.</p><br><p>However, to fix it immediately, you can persuade the stack view to re-layout either by moving its frame by one point and back or temporarily changing one of its layout properties.</p><br><p>To demonstrate this, change the <em>Alignment</em> from <em>Fill</em> to <em>Top</em> and then back to <em>Fill</em>. You&#8217;ll now see the stars label positioned correctly:</p><br><p><img class="aligncenter size-full wp-image-114581 bordered" src="http://www.raywenderlich.com/wp-content/uploads/2015/09/27-change-alignment-to-top-and-back_640x85.png" alt="27-change-alignment-to-top-and-back_640x85" width="640" height="85" srcset="https://cdn2.raywenderlich.com/wp-content/uploads/2015/09/27-change-alignment-to-top-and-back_640x85.png 640w, https://cdn2.raywenderlich.com/wp-content/uploads/2015/09/27-change-alignment-to-top-and-back_640x85-480x64.png 480w" sizes="(max-width: 640px) 100vw, 640px"></p><br><p>Build and run to verify that everything looks exactly the same as before.</p><br><h3>Unembedding a stack view</h3><br><p>Before you go too far, it&#8217;s good to have some basic &#8220;first aid&#8221; training. Sometimes you may find yourself with an extra stack view that you no longer need, perhaps because of experimentation, refactoring or just by accident.</p><br><p>Fortunately, there is an easy way to <i>unembed</i> views from a stack view.</p><br><p>First, you&#8217;d select the stack view you want to remove. Then hold down the <em>Option</em> key and click on the <em>Stack</em> button. The click <em>Unembed</em> on the context menu that appears:</p><br><p><img class="aligncenter size-full wp-image-114582 bordered" src="http://www.raywenderlich.com/wp-content/uploads/2015/09/28-how-to-unembed_186x71.png" alt="28-how-to-unembed_186x71" width="186" height="71"></p><br><p>Another way to do this is to select the stack view and then choose <em>Editor </em><em>\</em><em> Unembed</em> from the menu.</p><br><h3>Your first vertical stack view</h3><br><p>Now, you&#8217;ll create your first vertical stack view. Select the <em>WHY VISIT</em> label and the <em>&lt;</em><em>whyVisitLabel&gt;</em> below it:</p><br><p><img class="aligncenter size-full wp-image-114583 bordered" src="http://www.raywenderlich.com/wp-content/uploads/2015/09/29-select-why-visit-labels_640x90.png" alt="29-select-why-visit-labels_640x90" width="640" height="90" srcset="https://cdn5.raywenderlich.com/wp-content/uploads/2015/09/29-select-why-visit-labels_640x90.png 640w, https://cdn5.raywenderlich.com/wp-content/uploads/2015/09/29-select-why-visit-labels_640x90-480x68.png 480w" sizes="(max-width: 640px) 100vw, 640px"></p><br><p>Xcode will correctly infer that this should be a vertical stack view based on the position of the labels. Click the <em>Stack</em> button to embed both of these in a stack view:</p><br><p><img class="aligncenter size-full wp-image-114584 bordered" src="http://www.raywenderlich.com/wp-content/uploads/2015/09/30-embed-why-visit-labels_640x90.png" alt="30-embed-why-visit-labels_640x90" width="640" height="90" srcset="https://cdn5.raywenderlich.com/wp-content/uploads/2015/09/30-embed-why-visit-labels_640x90.png 640w, https://cdn5.raywenderlich.com/wp-content/uploads/2015/09/30-embed-why-visit-labels_640x90-480x68.png 480w" sizes="(max-width: 640px) 100vw, 640px"></p><br><p>The lower label previously had a constraint pinning it to the right margin of the view, but that constraint was removed when it was embedded in the stack view. Currently, the stack view has no constraints, so it adopts the intrinsic width of its largest view.</p><br><p>With the stack view selected, click on the <em>Pin</em> button. Checkmark <em>Constrain to margins</em>, and set the <em>Top</em>, <em>Leading</em> and <em>Trailing</em> constraints to <em>0</em>.</p><br><p>Then, click on the dropdown to the right of the bottom constraint and select <em>WEATHER (current distance = 20)</em>:</p><br><p><img class="aligncenter size-full wp-image-114585 bordered" src="http://www.raywenderlich.com/wp-content/uploads/2015/09/31-dont-select-nearest-neighbor-constraint_463x417.png" alt="31-dont-select-nearest-neighbor-constraint_463x417" width="463" height="417" srcset="https://cdn4.raywenderlich.com/wp-content/uploads/2015/09/31-dont-select-nearest-neighbor-constraint_463x417.png 463w, https://cdn4.raywenderlich.com/wp-content/uploads/2015/09/31-dont-select-nearest-neighbor-constraint_463x417-355x320.png 355w" sizes="(max-width: 463px) 100vw, 463px"></p><br><p>By default, constraints are shown to the nearest neighbor, which for the bottom constraint is the <em>Hide</em> button at a distance of 15. You actually needed the constraint to be to the <em>WEATHER</em> label below it.</p><br><p>Finally, click <em>Add 4 Constraints</em>. You should now see the following:</p><br><p><img class="aligncenter size-full wp-image-114586 bordered" src="http://www.raywenderlich.com/wp-content/uploads/2015/09/32-why-visit-stack-view-stretched_640x90.png" alt="32-why-visit-stack-view-stretched_640x90" width="640" height="90" srcset="https://cdn1.raywenderlich.com/wp-content/uploads/2015/09/32-why-visit-stack-view-stretched_640x90.png 640w, https://cdn1.raywenderlich.com/wp-content/uploads/2015/09/32-why-visit-stack-view-stretched_640x90-480x68.png 480w" sizes="(max-width: 640px) 100vw, 640px"></p><br><p>You now have an expanded stack view with its right edges pinned to the right margin of the view. However, the bottom label is still the same width. You&#8217;ll fix this by updating the stack view&#8217;s <code>alignment</code> property.</p><br><h3>Alignment property</h3><br><p>The <code>alignment</code> property determines how a stack view lays out its views <i>perpendicular</i> to its axis. For a vertical stack view, the possible values are <code>Fill</code>, <code>Leading</code>, <code>Center</code> and <code>Trailing</code>.</p><br><p>The possible <code>alignment</code> values for a <i>horizontal</i> stack view differ slightly:</p><br><p><img class="aligncenter size-full wp-image-114587" src="http://www.raywenderlich.com/wp-content/uploads/2015/09/33-horizontal-and-vertical-alignment_594x171.png" alt="33-horizontal-and-vertical-alignment_594x171" width="594" height="171" srcset="https://cdn4.raywenderlich.com/wp-content/uploads/2015/09/33-horizontal-and-vertical-alignment_594x171.png 594w, https://cdn4.raywenderlich.com/wp-content/uploads/2015/09/33-horizontal-and-vertical-alignment_594x171-480x138.png 480w" sizes="(max-width: 594px) 100vw, 594px"></p><br><p>It has <code>.Top</code> instead of <code>.Leading</code> and has <code>.Bottom</code> instead of <code>.Trailing</code>. There are also two more properties that are valid only in the horizontal direction, <code>.FirstBaseline</code> and <code>.LastBaseline</code>.</p><br><p>Select each value to see how it affects the placement of the labels for the vertical stack view:</p><br><p><em>Fill:</em></p><br><p><img class="aligncenter size-full wp-image-114588 bordered" src="http://www.raywenderlich.com/wp-content/uploads/2015/09/34-alignment-fill_640x64.png" alt="34-alignment-fill_640x64" width="640" height="64" srcset="https://cdn3.raywenderlich.com/wp-content/uploads/2015/09/34-alignment-fill_640x64.png 640w, https://cdn3.raywenderlich.com/wp-content/uploads/2015/09/34-alignment-fill_640x64-480x48.png 480w" sizes="(max-width: 640px) 100vw, 640px"></p><br><p><em>Leading:</em></p><br><p><img class="aligncenter size-full wp-image-114589 bordered" src="http://www.raywenderlich.com/wp-content/uploads/2015/09/35-alignment-leading_640x64.png" alt="35-alignment-leading_640x64" width="640" height="64" srcset="https://cdn5.raywenderlich.com/wp-content/uploads/2015/09/35-alignment-leading_640x64.png 640w, https://cdn5.raywenderlich.com/wp-content/uploads/2015/09/35-alignment-leading_640x64-480x48.png 480w" sizes="(max-width: 640px) 100vw, 640px"></p><br><p><em>Center:</em></p><br><p><img class="aligncenter size-full wp-image-114590 bordered" src="http://www.raywenderlich.com/wp-content/uploads/2015/09/36-alignment-center_640x64.png" alt="36-alignment-center_640x64" width="640" height="64" srcset="https://cdn4.raywenderlich.com/wp-content/uploads/2015/09/36-alignment-center_640x64.png 640w, https://cdn4.raywenderlich.com/wp-content/uploads/2015/09/36-alignment-center_640x64-480x48.png 480w" sizes="(max-width: 640px) 100vw, 640px"></p><br><p><em>Trailing:</em></p><br><p><img class="aligncenter size-full wp-image-114591 bordered" src="http://www.raywenderlich.com/wp-content/uploads/2015/09/37-alignment-trailing_640x64.png" alt="37-alignment-trailing_640x64" width="640" height="64" srcset="https://cdn3.raywenderlich.com/wp-content/uploads/2015/09/37-alignment-trailing_640x64.png 640w, https://cdn3.raywenderlich.com/wp-content/uploads/2015/09/37-alignment-trailing_640x64-480x48.png 480w" sizes="(max-width: 640px) 100vw, 640px"></p><br><p>When you&#8217;re done testing each value, set the <em>Alignment</em> to <em>Fill</em>:</p><br><p><img class="aligncenter size-full wp-image-114592 bordered" src="http://www.raywenderlich.com/wp-content/uploads/2015/09/38-now-select-alignment-fill_640x64.png" alt="38-now-select-alignment-fill_640x64" width="640" height="64" srcset="https://cdn3.raywenderlich.com/wp-content/uploads/2015/09/38-now-select-alignment-fill_640x64.png 640w, https://cdn3.raywenderlich.com/wp-content/uploads/2015/09/38-now-select-alignment-fill_640x64-480x48.png 480w" sizes="(max-width: 640px) 100vw, 640px"></p><br><p>Then build and run to verify that everything looks good and that there are no regressions.</p><br><p>Specifying <code>Fill</code> means you want all the views to completely fill the stack view perpendicular to its axis. This causes the <em>WHY VISIT</em> label to expand itself to the right edge as well.</p><br><p>But what if you only wanted the bottom label to expand itself to the edge?</p><br><p>For now, it doesn&#8217;t matter since both labels will have a clear background at runtime, but it will matter when you&#8217;re converting the weather section.</p><br><p>You&#8217;ll learn how to accomplish that with the use of an additional stack view.</p><br><h3>Convert the &#8220;what to see&#8221; section</h3><br><p>This section is very similar to the previous one, so the instructions here are brief.</p><br><ol start="1"><br><li>First, select the <em>WHAT TO SEE</em> label and the <em>&lt;</em><em>whatToSeeLabel&gt;</em> below it.</li><br><li>Click on the <em>Stack</em> button.</li><br><li>Click on the <em>Pin</em> button.</li><br><li>Checkmark <em>Constrain to margins</em>, and add the following <em>four</em> constraints:</li><br></ol><br><br><div class="wp_codebox"><table><tr id="p1145525"><td class="code" id="p114552code5"><pre class="bash" style="font-family:monospace;">Top: <span style="color: #000000;">20</span>, Leading: <span style="color: #000000;">0</span>, Trailing: <span style="color: #000000;">0</span>, Bottom: <span style="color: #000000;">20</span></pre></td></tr></table></div><br><br><ol start="5"><br><li>Set the stack view&#8217;s <em>Alignment</em> to <em>Fill</em>.</li><br></ol><br><p>Your storyboard should now look like this:</p><br><p><img class="aligncenter size-full wp-image-114593 bordered" src="http://www.raywenderlich.com/wp-content/uploads/2015/09/39-after-what-to-see-section_640x308.png" alt="39-after-what-to-see-section_640x308" width="640" height="308" srcset="https://cdn4.raywenderlich.com/wp-content/uploads/2015/09/39-after-what-to-see-section_640x308.png 640w, https://cdn4.raywenderlich.com/wp-content/uploads/2015/09/39-after-what-to-see-section_640x308-480x231.png 480w" sizes="(max-width: 640px) 100vw, 640px"></p><br><p>Build and run to verify that everything still looks the same.</p><br><p>This leaves you with just the <em>weather</em> section left.</p><br><h2>Convert the weather section</h2><br><p>The <em>weather</em> section is more complex than the others due to the inclusion of the <em>Hide</em> button.</p><br><p>One approach you could take would be to create a nested stack view by embedding the <em>WEATHER</em> label and the <em>Hide</em> button into a horizontal stack view, and then embedding that horizontal stack view and the <em>&lt;</em><em>weatherInfoLabel&gt;</em> into a vertical stack view.</p><br><p>It would look something like this:</p><br><p><img class="aligncenter size-full wp-image-114594 bordered" src="http://www.raywenderlich.com/wp-content/uploads/2015/09/40-weather-stack-in-stack_640x92.png" alt="40-weather-stack-in-stack_640x92" width="640" height="92" srcset="https://cdn1.raywenderlich.com/wp-content/uploads/2015/09/40-weather-stack-in-stack_640x92.png 640w, https://cdn1.raywenderlich.com/wp-content/uploads/2015/09/40-weather-stack-in-stack_640x92-480x69.png 480w" sizes="(max-width: 640px) 100vw, 640px"></p><br><p>Notice that the <em>WEATHER</em> label has expanded to be equal to the height of the <em>Hide</em> button. This isn&#8217;t ideal since this will cause there to be extra space between the baseline of the <em>WEATHER</em> label and the text below it.</p><br><p>Remember that <code>alignment</code> specifies positioning perpendicular to the stack view. So, you could set the <code>alignment</code> to <em>Bottom</em>:</p><br><p><img class="aligncenter size-full wp-image-114595 bordered" src="http://www.raywenderlich.com/wp-content/uploads/2015/09/41-weather-stack-in-stack-alignment-bottom_640x92.png" alt="41-weather-stack-in-stack-alignment-bottom_640x92" width="640" height="92" srcset="https://cdn2.raywenderlich.com/wp-content/uploads/2015/09/41-weather-stack-in-stack-alignment-bottom_640x92.png 640w, https://cdn2.raywenderlich.com/wp-content/uploads/2015/09/41-weather-stack-in-stack-alignment-bottom_640x92-480x69.png 480w" sizes="(max-width: 640px) 100vw, 640px"></p><br><p>But you really don&#8217;t want the height of the <em>Hide</em> button to dictate the height of the stack view.</p><br><p>The actual approach you&#8217;ll take is to have the <em>Hide</em> button <i>not</i> be in the stack view for the <em>weather</em> section, or any other stack view for that matter.</p><br><p>It will remain a subview of the top-level view, and you&#8217;ll add a constraint from it to the <em>WEATHER</em> label — which will be in a stack view. That&#8217;s right, you&#8217;ll add a constraint from a button outside of a stack view to a label within a stack view!</p><br><p>Select the <em>WEATHER</em> label and the <em>&lt;</em><em>weatherInfoLabel&gt;</em> below it:</p><br><p><img class="aligncenter size-full wp-image-114596 bordered" src="http://www.raywenderlich.com/wp-content/uploads/2015/09/42-select-weather-and-info-label_640x92.png" alt="42-select-weather-and-info-label_640x92" width="640" height="92" srcset="https://cdn5.raywenderlich.com/wp-content/uploads/2015/09/42-select-weather-and-info-label_640x92.png 640w, https://cdn5.raywenderlich.com/wp-content/uploads/2015/09/42-select-weather-and-info-label_640x92-480x69.png 480w" sizes="(max-width: 640px) 100vw, 640px"></p><br><p>Click on the <em>Stack</em> button:</p><br><p><img class="aligncenter size-full wp-image-114597 bordered" src="http://www.raywenderlich.com/wp-content/uploads/2015/09/43-weather-click-stack-button_640x92.png" alt="43-weather-click-stack-button_640x92" width="640" height="92" srcset="https://cdn1.raywenderlich.com/wp-content/uploads/2015/09/43-weather-click-stack-button_640x92.png 640w, https://cdn1.raywenderlich.com/wp-content/uploads/2015/09/43-weather-click-stack-button_640x92-480x69.png 480w" sizes="(max-width: 640px) 100vw, 640px"></p><br><p>Click on the <em>Pin</em> button, checkmark <em>Constrain to margins</em> and add the following <em>four</em> constraints:</p>

<div class="wp_codebox"><table><tr id="p1145526"><td class="code" id="p114552code6"><pre class="bash" style="font-family:monospace;">Top: <span style="color: #000000;">20</span>, Leading: <span style="color: #000000;">0</span>, Trailing: <span style="color: #000000;">0</span>, Bottom: <span style="color: #000000;">20</span></pre></td></tr></table></div>

<p>Set the stack view&#8217;s <em>Alignment</em> to <em>Fill</em>:</p><br><p><img class="aligncenter size-full wp-image-114598 bordered" src="http://www.raywenderlich.com/wp-content/uploads/2015/09/44-weather-alignment-fill_640x92.png" alt="44-weather-alignment-fill_640x92" width="640" height="92" srcset="https://cdn1.raywenderlich.com/wp-content/uploads/2015/09/44-weather-alignment-fill_640x92.png 640w, https://cdn1.raywenderlich.com/wp-content/uploads/2015/09/44-weather-alignment-fill_640x92-480x69.png 480w" sizes="(max-width: 640px) 100vw, 640px"></p><br><p>You need a constraint between the <em>Hide</em> button&#8217;s left edge and the <em>WEATHER</em> label&#8217;s right edge, so having the <em>WEATHER</em> label fill the stack view won&#8217;t work.</p><br><p>However, you <i>do</i> want the bottom <em>&lt;</em><em>weatherInfoLabel&gt;</em> to fill the stack view.</p><br><p>You can accomplish this by embedding just the <em>WEATHER</em> label into a vertical stack view. Remember that the <code>alignment</code> of a vertical stack view can be set to <code>.Leading</code>, and if the stack view is stretched beyond its intrinsic width, its contained views will remain aligned to its leading side.</p><br><p>Select the <em>WEATHER</em> label using the document outline, or by using the <em>Control-Shift-click</em> method:</p><br><p><img class="aligncenter size-full wp-image-114599 bordered" src="http://www.raywenderlich.com/wp-content/uploads/2015/09/45-select-just-the-weather-label_640x92.png" alt="45-select-just-the-weather-label_640x92" width="640" height="92" srcset="https://cdn5.raywenderlich.com/wp-content/uploads/2015/09/45-select-just-the-weather-label_640x92.png 640w, https://cdn5.raywenderlich.com/wp-content/uploads/2015/09/45-select-just-the-weather-label_640x92-480x69.png 480w" sizes="(max-width: 640px) 100vw, 640px"></p><br><p>Then click on the <em>Stack</em> button:</p><br><p><img class="aligncenter size-full wp-image-114600 bordered" src="http://www.raywenderlich.com/wp-content/uploads/2015/09/46-weather-in-horizontal-stack_640x92.png" alt="46-weather-in-horizontal-stack_640x92" width="640" height="92" srcset="https://cdn1.raywenderlich.com/wp-content/uploads/2015/09/46-weather-in-horizontal-stack_640x92.png 640w, https://cdn1.raywenderlich.com/wp-content/uploads/2015/09/46-weather-in-horizontal-stack_640x92-480x69.png 480w" sizes="(max-width: 640px) 100vw, 640px"></p><br><p>Set <em>Alignment</em> to <em>Leading</em>, and make sure <em>Axis</em> is set to <em>Vertical</em>:</p><br><p><img class="aligncenter size-full wp-image-114601 bordered" src="http://www.raywenderlich.com/wp-content/uploads/2015/09/47-vertical-and-leading_640x92.png" alt="47-vertical-and-leading_640x92" width="640" height="92" srcset="https://cdn2.raywenderlich.com/wp-content/uploads/2015/09/47-vertical-and-leading_640x92.png 640w, https://cdn2.raywenderlich.com/wp-content/uploads/2015/09/47-vertical-and-leading_640x92-480x69.png 480w" sizes="(max-width: 640px) 100vw, 640px"></p><br><p>Perfect! You&#8217;ve got the outer stack view stretching the inner stack view to fill the width, but the inner stack view allows the label to keep its original width!</p><br><p>Build and run. Why on earth is the <em>Hide</em> button hanging out in the middle of the text?</p><br><p><img class="aligncenter wp-image-114602 size-medium bordered" src="http://www.raywenderlich.com/wp-content/uploads/2015/09/48-hide-label-incorrect-position_750x573-419x320.png" alt="48-hide-label-incorrect-position_750x573" width="419" height="320" srcset="https://cdn1.raywenderlich.com/wp-content/uploads/2015/09/48-hide-label-incorrect-position_750x573-419x320.png 419w, https://cdn1.raywenderlich.com/wp-content/uploads/2015/09/48-hide-label-incorrect-position_750x573-654x500.png 654w, https://cdn1.raywenderlich.com/wp-content/uploads/2015/09/48-hide-label-incorrect-position_750x573.png 750w" sizes="(max-width: 419px) 100vw, 419px"></p><br><p>It&#8217;s because when you embedded the <em>WEATHER</em> label in a stack view, any constraints between it and the <em>Hide</em> button were removed.</p><br><p>To add new constraints <em>Control-drag</em> from the <em>Hide</em> button to the <em>WEATHER</em> label:</p><br><p><img class="aligncenter size-full wp-image-114603 bordered" src="http://www.raywenderlich.com/wp-content/uploads/2015/09/49-drag-to-weather-label_380x94.png" alt="49-drag-to-weather-label_380x94" width="380" height="94"></p><br><p>Hold down <em>Shift</em> to select multiple options, and select <em>Horizontal Spacing</em> and <em>Baseline</em>. Then click on <em>Add Constraints</em>:</p><br><p><img class="aligncenter size-full wp-image-114604 bordered" src="http://www.raywenderlich.com/wp-content/uploads/2015/09/50-add-multiple-constraints_380x224.png" alt="50-add-multiple-constraints_380x224" width="380" height="224"></p><br><p>Build and run. The <em>Hide</em> button should now be positioned correctly, and since the label that is being set to hidden is embedded in a stack view, pressing <em>Hide</em> hides the label, and adjusts the views below it — all without having to manually adjust any constraints.</p><br><p><img class="aligncenter size-medium wp-image-114605 bordered" src="http://www.raywenderlich.com/wp-content/uploads/2015/09/51-hide-button-works_750x732-328x320.png" alt="51-hide-button-works_750x732" width="328" height="320" srcset="https://cdn1.raywenderlich.com/wp-content/uploads/2015/09/51-hide-button-works_750x732-328x320.png 328w, https://cdn1.raywenderlich.com/wp-content/uploads/2015/09/51-hide-button-works_750x732-512x500.png 512w, https://cdn1.raywenderlich.com/wp-content/uploads/2015/09/51-hide-button-works_750x732-32x32.png 32w, https://cdn1.raywenderlich.com/wp-content/uploads/2015/09/51-hide-button-works_750x732.png 750w" sizes="(max-width: 328px) 100vw, 328px"></p><br><p>Now that all the sections are in unique stack views, you&#8217;re set to embed them all into an outer stack view, which will make the final two tasks trivial.</p><br><h3>Top-level stack view</h3><br><p><em>Command-click</em> to select all five top-level stack views in the outline view:</p><br><p><img class="aligncenter size-full wp-image-114606 bordered" src="http://www.raywenderlich.com/wp-content/uploads/2015/09/52-select-all-stack-views-in-outline_640x260.png" alt="52-select-all-stack-views-in-outline_640x260" width="640" height="260" srcset="https://cdn4.raywenderlich.com/wp-content/uploads/2015/09/52-select-all-stack-views-in-outline_640x260.png 640w, https://cdn4.raywenderlich.com/wp-content/uploads/2015/09/52-select-all-stack-views-in-outline_640x260-480x195.png 480w" sizes="(max-width: 640px) 100vw, 640px"></p><br><p>Then click on the <em>Stack</em> button:</p><br><p><img class="aligncenter size-full wp-image-114607 bordered" src="http://www.raywenderlich.com/wp-content/uploads/2015/09/53-stack-all-the-views_640x185.png" alt="53-stack-all-the-views_640x185" width="640" height="185" srcset="https://cdn3.raywenderlich.com/wp-content/uploads/2015/09/53-stack-all-the-views_640x185.png 640w, https://cdn3.raywenderlich.com/wp-content/uploads/2015/09/53-stack-all-the-views_640x185-480x139.png 480w" sizes="(max-width: 640px) 100vw, 640px"></p><br><p>Click the <em>Pin</em> button, checkmark <em>Constrain to margins</em> add constraints of <em>0</em> to all edges. Then set <em>Spacing</em> to <em>20</em> and <em>Alignment</em> to <em>Fill</em>. Your storyboard scene should now look like this:</p><br><p><img class="aligncenter size-full wp-image-114608 bordered" src="http://www.raywenderlich.com/wp-content/uploads/2015/09/54-set-the-spacing-to-20-and-alignment-to-fill_640x300.png" alt="54-set-the-spacing-to-20-and-alignment-to-fill_640x300" width="640" height="300" srcset="https://cdn5.raywenderlich.com/wp-content/uploads/2015/09/54-set-the-spacing-to-20-and-alignment-to-fill_640x300.png 640w, https://cdn5.raywenderlich.com/wp-content/uploads/2015/09/54-set-the-spacing-to-20-and-alignment-to-fill_640x300-480x225.png 480w" sizes="(max-width: 640px) 100vw, 640px"></p><br><p>Build and run:</p><br><p><img class="aligncenter size-medium wp-image-114609 bordered" src="http://www.raywenderlich.com/wp-content/uploads/2015/09/55-hide-button-lost-again_750x487-480x312.png" alt="55-hide-button-lost-again_750x487" width="480" height="312" srcset="https://cdn4.raywenderlich.com/wp-content/uploads/2015/09/55-hide-button-lost-again_750x487-480x312.png 480w, https://cdn4.raywenderlich.com/wp-content/uploads/2015/09/55-hide-button-lost-again_750x487-700x455.png 700w, https://cdn4.raywenderlich.com/wp-content/uploads/2015/09/55-hide-button-lost-again_750x487.png 750w" sizes="(max-width: 480px) 100vw, 480px"></p><br><p>Whoops! Looks like the hide button lost its constraints again when the <em>WEATHER</em> stack view was embedded in the outer stack view. No problem, just add constraints to it again in the same way you did before.</p><br><p><em>Control-drag</em> from the <em>Hide</em> button to the <em>WEATHER</em> label, hold down <em>Shift</em>, select both <em>Horizontal Spacing</em> and <em>Baseline</em>. Then click on <em>Add Constraints</em>:</p><br><p><img class="aligncenter size-full wp-image-114610 bordered" src="http://www.raywenderlich.com/wp-content/uploads/2015/09/56-add-constraints-to-button-again_380x223.png" alt="56-add-constraints-to-button-again_380x223" width="380" height="223"></p><br><p>Build and run. The <em>Hide</em> button is now positioned correctly.</p><br><h3>Repositioning views</h3><br><p>Now that all of the sections are in a top-level stack view, you&#8217;ll modify the position of the <em>what to see</em> section so that it&#8217;s positioned above the <em>weather</em> section.</p><br><p>Select the <em>middle stack view</em> from the outline view and <em>drag it between</em> the first and second view.</p><br><div class="note"><em>Note:</em> Keep the pointer slightly to the left of the stack views that you&#8217;re dragging it between so that it remains a <i>subview</i> of the outer stack view. The little blue circle should be positioned at the left edge between the two stack views and not at the right edge:</div><br><p><img class="aligncenter size-full wp-image-114611 bordered" src="http://www.raywenderlich.com/wp-content/uploads/2015/09/57-drag-and-drop-to-reposition-section_639x130.png" alt="57-drag-and-drop-to-reposition-section_639x130" width="639" height="130" srcset="https://cdn1.raywenderlich.com/wp-content/uploads/2015/09/57-drag-and-drop-to-reposition-section_639x130.png 639w, https://cdn1.raywenderlich.com/wp-content/uploads/2015/09/57-drag-and-drop-to-reposition-section_639x130-480x98.png 480w" sizes="(max-width: 639px) 100vw, 639px"></p><br><p>And now the <em>weather</em> section is third from the top, but since the <em>Hide</em> button isn&#8217;t part of the stack view, it won&#8217;t be moved, so its frame will now be misplaced.</p><br><p>Click on the <em>Hide</em> button to select it:</p><br><p><img class="aligncenter size-full wp-image-114612 bordered" src="http://www.raywenderlich.com/wp-content/uploads/2015/09/58-hide-button-not-moved_640x130.png" alt="58-hide-button-not-moved_640x130" width="640" height="130" srcset="https://cdn5.raywenderlich.com/wp-content/uploads/2015/09/58-hide-button-not-moved_640x130.png 640w, https://cdn5.raywenderlich.com/wp-content/uploads/2015/09/58-hide-button-not-moved_640x130-480x98.png 480w" sizes="(max-width: 640px) 100vw, 640px"></p><br><p>Then click on the <em>Resolve Auto Layout Issues</em> triangle shaped button in the Auto Layout toolbar and under the <em>Selected Views</em> section, click on <em>Update Frames</em>:</p><br><p><img class="aligncenter size-full wp-image-114613 bordered" src="http://www.raywenderlich.com/wp-content/uploads/2015/09/59-resolve-auto-layout-issues_356x269.png" alt="59-resolve-auto-layout-issues_356x269" width="356" height="269"></p><br><p>The <em>Hide</em> button will now be back in the correct position:</p><br><p><img class="aligncenter size-full wp-image-114614 bordered" src="http://www.raywenderlich.com/wp-content/uploads/2015/09/60-hide-button-back-to-correct-position_640x130.png" alt="60-hide-button-back-to-correct-position_640x130" width="640" height="130" srcset="https://cdn5.raywenderlich.com/wp-content/uploads/2015/09/60-hide-button-back-to-correct-position_640x130.png 640w, https://cdn5.raywenderlich.com/wp-content/uploads/2015/09/60-hide-button-back-to-correct-position_640x130-480x98.png 480w" sizes="(max-width: 640px) 100vw, 640px"></p><br><p>Granted, repositioning the view with Auto Layout and re-adding constraints would not have been the most difficult thing you&#8217;ve ever done, but didn&#8217;t this feel oh-so-much nicer?</p><br><h3>Size class based configuration</h3><br><p>Finally, you can turn your attention to the one remaining task on your list. In landscape mode, vertical space is at a premium, so you want to bring the sections of the stack view closer together. To do this, you&#8217;ll use size classes to set the spacing of the top-level stack view to <em>10</em> instead of <em>20</em> when the vertical size class is compact.</p><br><p>Select the top-level stack view and click on the little <em>+</em> button next to <em>Spacing</em>:</p><br><p><img class="aligncenter size-full wp-image-114615 bordered" src="http://www.raywenderlich.com/wp-content/uploads/2015/09/61-select-plus-button_260x120.png" alt="61-select-plus-button_260x120" width="260" height="120"></p><br><p>Choose <em>Any Width</em> &gt; <em>Compact Height</em>:</p><br><p><img class="aligncenter size-full wp-image-114616 bordered" src="http://www.raywenderlich.com/wp-content/uploads/2015/09/62-anywidth-compact-height_403x108.png" alt="62-anywidth-compact-height_403x108" width="403" height="108"></p><br><p>And set the <em>Spacing</em> to <em>10</em> in the new <em>wAny hC</em> field:</p><br><p><img class="aligncenter size-full wp-image-114617 bordered" src="http://www.raywenderlich.com/wp-content/uploads/2015/09/63-set-spacing-to-10_260x160.png" alt="63-set-spacing-to-10_260x160" width="260" height="160"></p><br><p>Build and run. The spacing in portrait mode should remain unchanged. Rotate the simulator (⌘←) and note that the spacing between the sections has decreased and the buttons now have ample space from the bottom of the view:</p><br><p><img class="aligncenter size-medium wp-image-114618 bordered" src="http://www.raywenderlich.com/wp-content/uploads/2015/09/64-spacing-in-iphone-landscape_1334x750-480x270.png" alt="64-spacing-in-iphone-landscape_1334x750" width="480" height="270" srcset="https://cdn1.raywenderlich.com/wp-content/uploads/2015/09/64-spacing-in-iphone-landscape_1334x750-480x270.png 480w, https://cdn1.raywenderlich.com/wp-content/uploads/2015/09/64-spacing-in-iphone-landscape_1334x750-700x394.png 700w, https://cdn1.raywenderlich.com/wp-content/uploads/2015/09/64-spacing-in-iphone-landscape_1334x750-266x151.png 266w, https://cdn1.raywenderlich.com/wp-content/uploads/2015/09/64-spacing-in-iphone-landscape_1334x750.png 1334w" sizes="(max-width: 480px) 100vw, 480px"></p><br><p>If you didn&#8217;t add a top-level stack view, you still <i>could</i> have used size classes to set the vertical spacing to 10 on each of the four constraints that separate the five sections, but isn&#8217;t it so much better to set it in just a single place?</p><br><p>You have better things to do with your time, like animation!</p><br><h2>Animation</h2><br><p>Currently, it&#8217;s a bit jarring when hiding and showing the weather details. You&#8217;ll add some animation to smooth the transition.</p><br><p>Stack views are fully compatible with the UIView animation engine. This means that animating the appearance/disappearance of an arranged subview, is as simple as toggling its <code>hidden</code> property <i>inside</i> an animation block.</p><br><p>It&#8217;s time to write some code! Open <em>SpotInfoViewController.swift</em> and take a look at <code>updateWeatherInfoViews(hideWeatherInfo:animated:)</code>.</p><br><p>You&#8217;ll see this line at the end of the method:</p>

<div class="wp_codebox"><table><tr id="p1145527"><td class="code" id="p114552code7"><pre class="swift" style="font-family:monospace;">weatherInfoLabel.hidden <span style="color: #002200;">=</span> shouldHideWeatherInfo</pre></td></tr></table></div>

<p>Replace it with the following:</p>

<div class="wp_codebox"><table><tr id="p1145528"><td class="code" id="p114552code8"><pre class="swift" style="font-family:monospace;"><span style="color: #a61390;">if</span> animated <span style="color: #002200;">&#123;</span><br>  <span style="color: #400080;">UIView</span>.animateWithDuration<span style="color: #002200;">&#40;</span><span style="color: #2400d9;">0.3</span><span style="color: #002200;">&#41;</span> <span style="color: #002200;">&#123;</span><br>    <span style="color: #a61390;">self</span>.weatherInfoLabel.hidden <span style="color: #002200;">=</span> shouldHideWeatherInfo<br>  <span style="color: #002200;">&#125;</span><br><span style="color: #002200;">&#125;</span> <span style="color: #a61390;">else</span> <span style="color: #002200;">&#123;</span><br>  weatherInfoLabel.hidden <span style="color: #002200;">=</span> shouldHideWeatherInfo<br><span style="color: #002200;">&#125;</span></pre></td></tr></table></div>

<p>Build and run, and tap the <em>Hide</em> or <em>Show</em> button. Doesn&#8217;t the animated version feel much nicer?</p><br><p>In addition to animating the hidden property on views contained within the stack view, you can also animate properties on the stack view itself, such as <code>alignment</code>, <code>distribution</code>, <code>spacing</code> and even the <code>axis</code>.</p><br><h2>Where to go from here?</h2><br><p>You can download the completed project <a href="http://www.raywenderlich.com/wp-content/uploads/2015/09/VacationSpots_Complete.zip" target="_blank" rel="external">here</a>.</p><br><p>In this UIStackView tutorial, you learned a lot about stack views as well as the various properties that a stack view uses to position its subviews. Stack views are highly configurable, and there may be more than one way achieve the same result.</p><br><p>The best way to build on what you&#8217;ve learned is to experiment with various properties yourself. Instead of setting a property and moving on, see how playing with the other properties affects the layout of views within the stack view.</p><br><p>This tutorial was an abbreviated version of Chapter 6, &#8220;UIStackView and Auto Layout changes&#8221; and Chapter 7, &#8220;Intermediate UIStackView&#8221; from iOS 9 by Tutorials. If you&#8217;d like to learn more about UIStackView and other new features in iOS 9 please <a href="http://www.raywenderlich.com/store" target="_blank" rel="external">check out the book</a>!</p><br><p>In the meantime, if you have any questions or comments about this tutorial or Stack Views in general, please join the forum discussion below!</p>


        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">


</div>




<div class="comments-count">
	
</div>

</footer>


    </article>






   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2016/09/14/UISearchController-使用指导/" title="UISearchController 使用指导" itemprop="url">UISearchController 使用指导</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="跳跳魔王" target="_blank" itemprop="author">跳跳魔王</a>
		
  <p class="article-time">
    <time datetime="2016-09-14T00:59:02.000Z" itemprop="datePublished"> 发表于 2016-09-14</time>
    
  </p>
</header>
    <div class="article-content">
        
        <div align="center"><img src="http://www.raywenderlich.com/wp-content/uploads/2015/09/UISearchController-Square.png" width="250" height="250" class="alignright size-thumbnail wp-image-78152"></div>

<p>如果你的程序要展示大量的数据集, 通过滚动大规模的列表会变的很慢并且令人沮丧。 既然如此，允许用户搜索特定项目就显得非常重要。 幸运的是, UIKit 包含的 <code>UISearchBar</code> 和 <code>UITableView</code>实现了无缝对接来进行快速有效的信息过滤。</p><br><p>这份<code>UISearchController</code> 指导, 你将建立一个基于标准列表的Candy 应用。 你会添加搜索的功能, 包括动态过滤, 可选的scope bar, 所有使用 <code>UISearchController</code>的方式, 都已经添加到iOS 8. 最后, 你会知道如何让你的程序更加友好并且满足用户的紧急需求。</p><br><p>预备好一些糖衣的搜索结果，继续读下去。</p><br><h2>准备开始</h2><br><p>下载演示程序在<a href="http://www.raywenderlich.com/wp-content/uploads/2015/09/CandySearch-Starter.zip" target="_blank" rel="external">这里</a> 然后打开。 程序以导航栏的风格创建，编译项目并运行，你会看到一个空列表:</p>

<div align="center"><img src="http://www.raywenderlich.com/wp-content/uploads/2015/09/UISearchController-Starter-281x500.png" width="281" height="500" class="aligncenter size-large wp-image-113862" srcset="https://cdn5.raywenderlich.com/wp-content/uploads/2015/09/UISearchController-Starter-281x500.png 281w, https://cdn5.raywenderlich.com/wp-content/uploads/2015/09/UISearchController-Starter-180x320.png 180w, https://cdn5.raywenderlich.com/wp-content/uploads/2015/09/UISearchController-Starter.png 750w" sizes="(max-width: 281px) 100vw, 281px"></div><br><p>回到Xcode, 文件<em>Candy.swift</em> 包含了一个用来保存你想展示的糖果信息的类。这个类有两个属性: 分类和糖果名。</p><br><p>当用户在你的app搜索某个糖果的时候, 你要引用名字属性来匹配用户的搜索关键字。 你会在文章结尾实现的Scope Bar中看到分类字符串的重要性。</p><br><h2>填充 Table View</h2><br><p>打开 <em>MasterViewController.swift</em>.  <code>candies</code> 属性负责管理用户搜索用的不同的<code>Candy</code>对象。 说到这里, 是时候创建一些 Candy了!</p><br><p>这个指导中, 你只需要创建固定数量的数据来展示search bar如何工作的; 在真正的产品级应用中, 你可能会有上千条的数据。不过无论怎样，不管程序存在上千的数据还是只有一点点数据，用到的方法都是一样的。 出色的扩展性!</p><br><p>填充你的 <code>candies</code> 数组,添加下面的代码到 <code>viewDidLoad()</code>, 代码添加在 <code>super.viewDidLoad()</code>调用后:</p><br><br><div class="wp_codebox"><table><tr id="p1137721"><td class="code" id="p113772code1"><pre class="swift" style="font-family:monospace;">candies <span style="color: #002200;">=</span> <span style="color: #002200;">&#91;</span><br>  Candy<span style="color: #002200;">&#40;</span>category<span style="color: #002200;">:</span><span style="color: #bf1d1a;">&quot;Chocolate&quot;</span>, name<span style="color: #002200;">:</span><span style="color: #bf1d1a;">&quot;Chocolate Bar&quot;</span><span style="color: #002200;">&#41;</span>,<br>  Candy<span style="color: #002200;">&#40;</span>category<span style="color: #002200;">:</span><span style="color: #bf1d1a;">&quot;Chocolate&quot;</span>, name<span style="color: #002200;">:</span><span style="color: #bf1d1a;">&quot;Chocolate Chip&quot;</span><span style="color: #002200;">&#41;</span>,<br>  Candy<span style="color: #002200;">&#40;</span>category<span style="color: #002200;">:</span><span style="color: #bf1d1a;">&quot;Chocolate&quot;</span>, name<span style="color: #002200;">:</span><span style="color: #bf1d1a;">&quot;Dark Chocolate&quot;</span><span style="color: #002200;">&#41;</span>,<br>  Candy<span style="color: #002200;">&#40;</span>category<span style="color: #002200;">:</span><span style="color: #bf1d1a;">&quot;Hard&quot;</span>, name<span style="color: #002200;">:</span><span style="color: #bf1d1a;">&quot;Lollipop&quot;</span><span style="color: #002200;">&#41;</span>,<br>  Candy<span style="color: #002200;">&#40;</span>category<span style="color: #002200;">:</span><span style="color: #bf1d1a;">&quot;Hard&quot;</span>, name<span style="color: #002200;">:</span><span style="color: #bf1d1a;">&quot;Candy Cane&quot;</span><span style="color: #002200;">&#41;</span>,<br>  Candy<span style="color: #002200;">&#40;</span>category<span style="color: #002200;">:</span><span style="color: #bf1d1a;">&quot;Hard&quot;</span>, name<span style="color: #002200;">:</span><span style="color: #bf1d1a;">&quot;Jaw Breaker&quot;</span><span style="color: #002200;">&#41;</span>,<br>  Candy<span style="color: #002200;">&#40;</span>category<span style="color: #002200;">:</span><span style="color: #bf1d1a;">&quot;Other&quot;</span>, name<span style="color: #002200;">:</span><span style="color: #bf1d1a;">&quot;Caramel&quot;</span><span style="color: #002200;">&#41;</span>,<br>  Candy<span style="color: #002200;">&#40;</span>category<span style="color: #002200;">:</span><span style="color: #bf1d1a;">&quot;Other&quot;</span>, name<span style="color: #002200;">:</span><span style="color: #bf1d1a;">&quot;Sour Chew&quot;</span><span style="color: #002200;">&#41;</span>,<br>  Candy<span style="color: #002200;">&#40;</span>category<span style="color: #002200;">:</span><span style="color: #bf1d1a;">&quot;Other&quot;</span>, name<span style="color: #002200;">:</span><span style="color: #bf1d1a;">&quot;Gummi Bear&quot;</span><span style="color: #002200;">&#41;</span><br><span style="color: #002200;">&#93;</span></pre></td></tr></table></div>

<p>再次编译运行你的工程。因为table view的代理和数据源方法都已经实现了，现在你可以看见一个有数据的table view了: </p><br><div align="center"><img src="http://www.raywenderlich.com/wp-content/uploads/2015/09/UISearchController-Data-281x500.png" width="281" height="500" class="aligncenter size-large wp-image-113861" srcset="https://cdn2.raywenderlich.com/wp-content/uploads/2015/09/UISearchController-Data-281x500.png 281w, https://cdn2.raywenderlich.com/wp-content/uploads/2015/09/UISearchController-Data-180x320.png 180w, https://cdn2.raywenderlich.com/wp-content/uploads/2015/09/UISearchController-Data.png 750w" sizes="(max-width: 281px) 100vw, 281px"></div><br><p>选择列表的一行，点击进入会展示对应糖果的详情页:</p><br><div align="center"><img src="http://www.raywenderlich.com/wp-content/uploads/2015/09/darkchocolate.png" width="281" height="500" class="aligncenter size-large wp-image-115841" srcset="https://cdn2.raywenderlich.com/wp-content/uploads/2015/09/darkchocolate.png 375w, https://cdn2.raywenderlich.com/wp-content/uploads/2015/09/darkchocolate-180x320.png 180w, https://cdn2.raywenderlich.com/wp-content/uploads/2015/09/darkchocolate-281x500.png 281w" sizes="(max-width: 281px) 100vw, 281px"></div><br><p>这么多的糖果，这么少的时间找到你想要的! 你需要一个<code>UISearchBar</code>.</p><br><h2>UISearchController介绍</h2><br><p>如果你查看<code>UISearchController</code> 文档, 你会发现这个文档懒的令人发指。 他一点搜索工作都不做。 这个类只是提供用户预期得到的标准接口而已。</p><br><p><code>UISearchController</code> 调用代理方法告知你的应用其他地方，你的用户正在做什么。你必须自己实现所有的函数来做字符串的匹配工作。</p><br><p>虽然这看起来有点吓人, 但是写自定义的搜索功能你可以自己控制准确的返回结果。 你的用户会非常赞赏这种智能快速的搜索。</p><br><p>如果你过去用过搜索列表, 你应该熟悉<code>UISearchDisplayController</code>。 从 iOS 8开始, 这个类已经被弃用，现在开始使用 <code>UISearchController</code>, 这个类简化了搜索的流程。</p><br><p>不走运的是, 写这篇文章的时候, Interface Builder 还不支持 <code>UISearchController</code>, 因此你要自己手动创建你的UI。</p><br><p>在 <em>MasterViewController.swift</em>, 添加一个新的属性:</p>

<div class="wp_codebox"><table><tr id="p1137722"><td class="code" id="p113772code2"><pre class="swift" style="font-family:monospace;"><span style="color: #a61390;">let</span> searchController <span style="color: #002200;">=</span> UISearchController<span style="color: #002200;">&#40;</span>searchResultsController<span style="color: #002200;">:</span> <span style="color: #a61390;">nil</span><span style="color: #002200;">&#41;</span></pre></td></tr></table></div>

<p>通过初始化 <code>UISearchController</code> 不带 <code>searchResultsController</code>, 告诉搜索页面你要用相同的搜索视图来展示搜索结果。如果你在这里用不同的视图控制器，那搜索结果就展示在替代的视图里。</p><br><p>下一步, 你需要给你的搜索视图控制器配置一些参数。还是在 <em>MasterViewController.swift</em>里面, 在 <code>viewDidLoad()</code>后面添加如下代码:</p>

<div class="wp_codebox"><table><tr id="p1137723"><td class="code" id="p113772code3"><pre class="swift" style="font-family:monospace;">  searchController.searchResultsUpdater <span style="color: #002200;">=</span> <span style="color: #a61390;">self</span><br>  searchController.dimsBackgroundDuringPresentation <span style="color: #002200;">=</span> <span style="color: #a61390;">false</span><br>  definesPresentationContext <span style="color: #002200;">=</span> <span style="color: #a61390;">true</span><br>  tableView.tableHeaderView <span style="color: #002200;">=</span> searchController.searchBar</pre></td></tr></table></div>

<p>这儿是你添加代码的说明:</p><br><ol><br><li><code>searchResultsUpdater</code> 是 <code>UISearchController</code>的属性遵守 <code>UISearchResultsUpdating</code>协议。 当<code>UISearchBar</code>中输入的文字改变时，该协议会通知你的类. 过会你就会在你的类实现这个协议的。</li><br><li>默认情况下, <code>UISearchController</code>出现时视图会黯淡下来。 当你使用别的视图控制器作为<code>searchResultsController</code>时会很有用. 这个情况下, 你已经设置当前视图来显示结果，因此你不希望视图是黯淡的。</li><br><li>通过在视图控制器设置<code>definesPresentationContext</code> 为 <code>true</code>, 当<code>UISearchController</code> 处于激活状态是，确保用户在导航到别的页面后,搜索条不会继续留在屏幕上。</li><br><li>最后, 添加 <code>searchBar</code> 到列表的 <code>tableHeaderView</code>。记住 Interface Builder 还不兼容<code>UISearchController</code>, 这个很必要。</li><br></ol><br><h3>UISearchResultsUpdating 和 Filtering</h3><br><p>建立好搜索控制之后, 你需要做一些编码工作来让它工作。 首先, 在<code>MasterViewController</code>顶部附近添加下面的属性:</p>

<div class="wp_codebox"><table><tr id="p1137724"><td class="code" id="p113772code4"><pre class="swift" style="font-family:monospace;"><span style="color: #a61390;">var</span> filteredCandies <span style="color: #002200;">=</span> <span style="color: #002200;">&#91;</span>Candy<span style="color: #002200;">&#93;</span><span style="color: #002200;">&#40;</span><span style="color: #002200;">&#41;</span></pre></td></tr></table></div>

<p>这个属性用例保存用户正在搜索的糖果。 下一步, 添加下面的辅助方法到 <code>MasterViewController</code>:</p>

<div class="wp_codebox"><table><tr id="p1137725"><td class="code" id="p113772code5"><pre class="swift" style="font-family:monospace;"><span style="color: #a61390;">func</span> filterContentForSearchText<span style="color: #002200;">&#40;</span>searchText<span style="color: #002200;">:</span> <span style="color: #a61390;">String</span>, scope<span style="color: #002200;">:</span> <span style="color: #a61390;">String</span> <span style="color: #002200;">=</span> <span style="color: #bf1d1a;">&quot;All&quot;</span><span style="color: #002200;">&#41;</span> <span style="color: #002200;">&#123;</span><br>  filteredCandies <span style="color: #002200;">=</span> candies.<span style="color: #a61390;">filter</span> <span style="color: #002200;">&#123;</span> candy <span style="color: #a61390;">in</span><br>    <span style="color: #a61390;">return</span> candy.name.lowercaseString.containsString<span style="color: #002200;">&#40;</span>searchText.lowercaseString<span style="color: #002200;">&#41;</span><br>  <span style="color: #002200;">&#125;</span><br>&nbsp;<br>  tableView.reloadData<span style="color: #002200;">&#40;</span><span style="color: #002200;">&#41;</span><br><span style="color: #002200;">&#125;</span></pre></td></tr></table></div>

<p>这个方法会通过<code>searchText</code>过滤<code>candies</code> 数据并把结果放进你刚刚添加的 <code>filteredCandies</code> 数组。现在不用担心<code>scope</code> 这个参数, 文章后面你会用到它。</p><br><p>为了让<code>MasterViewController</code> 响应搜索条, 还需要实现 <code>UISearchResultsUpdating</code>. 打开 <em>MasterViewController.swift</em> 添加下面的类扩展方法, 在 <code>MasterViewController</code> 主体外:</p>

<div class="wp_codebox"><table><tr id="p1137726"><td class="code" id="p113772code6"><pre class="swift" style="font-family:monospace;">extension MasterViewController<span style="color: #002200;">:</span> UISearchResultsUpdating <span style="color: #002200;">&#123;</span><br>  <span style="color: #a61390;">func</span> updateSearchResultsForSearchController<span style="color: #002200;">&#40;</span>searchController<span style="color: #002200;">:</span> UISearchController<span style="color: #002200;">&#41;</span> <span style="color: #002200;">&#123;</span><br>    filterContentForSearchText<span style="color: #002200;">&#40;</span>searchController.searchBar.text<span style="color: #002200;">!</span><span style="color: #002200;">&#41;</span><br>  <span style="color: #002200;">&#125;</span><br><span style="color: #002200;">&#125;</span></pre></td></tr></table></div>

<p> <code>updateSearchResultsForSearchController(<em>:)</em></code> 方法是唯一需要去实现的，用来遵守<code>UISearchResultsUpdating</code> 协议。</p><br><p>现在, 每当用户在搜索条添加或者移除文字的时候, <code>UISearchController</code> 都会通过这个方法通知 <code>MasterViewController</code> 。 这个方法只是通过当前搜索条中的文字简单调用一个帮手方法(你刚刚定义的)</p><br><p><code>filter()</code> 需要一个闭包类型 <code>(candy: Candy) -&gt; Bool</code>. 然后循环便利数组中的所有元素, 然后调用闭包, 为每个元素传入这个文字。</p><br><p>你可以用这个方法判定某个糖果是否是需要展示给用户的结果的其中一个。 要做到这点, 如果当前的糖果包含在过滤数组中你需要返回 <code>true</code> , 如果不是就返回 <code>false</code> 。</p><br><p>为了确定这个, <code>containsString(:)</code> 用来检测这个糖果的名字是不是包含 <code>searchText</code>. 但是在比较前, 你需要把两个字符串转换成全小写的字符串，用 <code>lowercaseString</code> 方法。 </p><br><div class="note"><em>备注:</em> 大部分时间, 当执行搜索的时候通过比较两个字符串的小写，我们可以轻易返回大小写不敏感的比较，用户并不用烦心大小写的问题。 现在, 你输入 &#8220;Chocolate&#8221; 或者 &#8220;chocolate&#8221; 任何一个都会返回匹配的糖果。 是不是很有用?! :]</div><br><p>编译并允许程序; 你会发现列表上面现在有了Search Bar 。</p><br><p>可是, 如果你输入搜索文字你会发现依然看不到任何过滤的结果。 要给什么? 这个很简单，因为你还没有写任何的代码去告诉列表如何使用过滤结果。</p><br><p>回到 <em>MasterViewController.swift</em>, 替换 <code>tableView(_:numberOfRowsInSection:)</code> 用下面的代码 :</p>

<div class="wp_codebox"><table><tr id="p1137727"><td class="code" id="p113772code7"><pre class="swift" style="font-family:monospace;"><span style="color: #a61390;">override</span> <span style="color: #a61390;">func</span> tableView<span style="color: #002200;">&#40;</span>tableView<span style="color: #002200;">:</span> <span style="color: #400080;">UITableView</span>, numberOfRowsInSection section<span style="color: #002200;">:</span> <span style="color: #a61390;">Int</span><span style="color: #002200;">&#41;</span> <span style="color: #002200;">-</span>&gt; <span style="color: #a61390;">Int</span> <span style="color: #002200;">&#123;</span><br>  <span style="color: #a61390;">if</span> searchController.active <span style="color: #002200;">&amp;&amp;</span> searchController.searchBar.text <span style="color: #002200;">!=</span> <span style="color: #bf1d1a;">&quot;&quot;</span> <span style="color: #002200;">&#123;</span><br>    <span style="color: #a61390;">return</span> filteredCandies.<span style="color: #a61390;">count</span><br>  <span style="color: #002200;">&#125;</span><br>  <span style="color: #a61390;">return</span> candies.<span style="color: #a61390;">count</span><br><span style="color: #002200;">&#125;</span></pre></td></tr></table></div>

<p>这儿变化不大, 你只是简单判断用户是否在搜索, 然后用过滤的结果或者正常的糖果来做数据源。</p><br><p>下一步, 替换 <code>tableView(_:cellForRowAtIndexPath:)</code> 用:</p>

<div class="wp_codebox"><table><tr id="p1137728"><td class="code" id="p113772code8"><pre class="swift" style="font-family:monospace;"><span style="color: #a61390;">override</span> <span style="color: #a61390;">func</span> tableView<span style="color: #002200;">&#40;</span>tableView<span style="color: #002200;">:</span> <span style="color: #400080;">UITableView</span>, cellForRowAtIndexPath indexPath<span style="color: #002200;">:</span> <span style="color: #400080;">NSIndexPath</span><span style="color: #002200;">&#41;</span> <span style="color: #002200;">-</span>&gt; <span style="color: #400080;">UITableViewCell</span> <span style="color: #002200;">&#123;</span><br>  <span style="color: #a61390;">let</span> cell <span style="color: #002200;">=</span> tableView.dequeueReusableCellWithIdentifier<span style="color: #002200;">&#40;</span><span style="color: #bf1d1a;">&quot;Cell&quot;</span>, forIndexPath<span style="color: #002200;">:</span> indexPath<span style="color: #002200;">&#41;</span><br>  <span style="color: #a61390;">let</span> candy<span style="color: #002200;">:</span> Candy<br>  <span style="color: #a61390;">if</span> searchController.active <span style="color: #002200;">&amp;&amp;</span> searchController.searchBar.text <span style="color: #002200;">!=</span> <span style="color: #bf1d1a;">&quot;&quot;</span> <span style="color: #002200;">&#123;</span><br>    candy <span style="color: #002200;">=</span> filteredCandies<span style="color: #002200;">&#91;</span>indexPath.row<span style="color: #002200;">&#93;</span><br>  <span style="color: #002200;">&#125;</span> <span style="color: #a61390;">else</span> <span style="color: #002200;">&#123;</span><br>    candy <span style="color: #002200;">=</span> candies<span style="color: #002200;">&#91;</span>indexPath.row<span style="color: #002200;">&#93;</span><br>  <span style="color: #002200;">&#125;</span><br>  cell.textLabel?.text <span style="color: #002200;">=</span> candy.name<br>  cell.detailTextLabel?.text <span style="color: #002200;">=</span> candy.category<br>  <span style="color: #a61390;">return</span> cell<br><span style="color: #002200;">&#125;</span></pre></td></tr></table></div>

<p>两个方法现在都会调用 <code>searchController</code>的属性<code>active</code> 来判断显示哪个数组。 </p><br><p>当用户点击 Search Bar的搜索区域时, <code>active</code> 会自动设置为 <code>true</code>. 如果搜索控制器是激活的, 你会看到用户是否在输入文字。 如果他们输入了, <code>filteredCandies</code> 数组会返回数据. 否则, 返回所有的数据。</p><br><p>回想一下, 搜索控制器自动处理展示和隐藏结果, 所以你的所有代码必须根据控制器的状态和用户是否输入来提供正确的数据 (过滤的或者未过滤的) 。</p><br><div align="center"><img src="http://www.raywenderlich.com/wp-content/uploads/2015/09/ragecomic.png" width="651" height="481" class="aligncenter size-full wp-image-114198" srcset="https://cdn4.raywenderlich.com/wp-content/uploads/2015/09/ragecomic.png 651w, https://cdn4.raywenderlich.com/wp-content/uploads/2015/09/ragecomic-433x320.png 433w" sizes="(max-width: 651px) 100vw, 651px"></div><br><p>编译并允许程序。 你已经得到一个可以运行的过滤列表行的 Search Bar。 好耶! </p><br><div align="center"><img src="http://www.raywenderlich.com/wp-content/uploads/2015/09/UISearchController-Filter-281x500.png" width="281" height="500" class="aligncenter size-large wp-image-113864" srcset="https://cdn5.raywenderlich.com/wp-content/uploads/2015/09/UISearchController-Filter-281x500.png 281w, https://cdn5.raywenderlich.com/wp-content/uploads/2015/09/UISearchController-Filter-180x320.png 180w, https://cdn5.raywenderlich.com/wp-content/uploads/2015/09/UISearchController-Filter.png 750w" sizes="(max-width: 281px) 100vw, 281px"></div><br><p>玩一会这个程序看看能不能搜到各种糖果。</p><br><p>存在不止一个问题。当你选择搜索列表的一行, 你可能注意到了详情页展示的是错误的糖果! 是时候修复这个问题了。</p><br><h2>给详情页传递数据</h2><br><p>当传递信息给详情页时, 你要确保控制器知道用户在使用哪个内容: 是整个列表还是搜索的结果。 还是在 <em>MasterViewController.swift</em>, 在 <code>prepareForSegue(_:sender:)</code>里, 找到下面的代码:</p>

<div class="wp_codebox"><table><tr id="p1137729"><td class="code" id="p113772code9"><pre class="swift" style="font-family:monospace;"><span style="color: #a61390;">let</span> candy <span style="color: #002200;">=</span> candies<span style="color: #002200;">&#91;</span>indexPath.row<span style="color: #002200;">&#93;</span></pre></td></tr></table></div>

<p>替换成下面的代码:</p>

<div class="wp_codebox"><table><tr id="p11377210"><td class="code" id="p113772code10"><pre class="swift" style="font-family:monospace;"><span style="color: #a61390;">let</span> candy<span style="color: #002200;">:</span> Candy<br><span style="color: #a61390;">if</span> searchController.active <span style="color: #002200;">&amp;&amp;</span> searchController.searchBar.text <span style="color: #002200;">!=</span> <span style="color: #bf1d1a;">&quot;&quot;</span> <span style="color: #002200;">&#123;</span><br>  candy <span style="color: #002200;">=</span> filteredCandies<span style="color: #002200;">&#91;</span>indexPath.row<span style="color: #002200;">&#93;</span><br><span style="color: #002200;">&#125;</span> <span style="color: #a61390;">else</span> <span style="color: #002200;">&#123;</span><br>  candy <span style="color: #002200;">=</span> candies<span style="color: #002200;">&#91;</span>indexPath.row<span style="color: #002200;">&#93;</span><br><span style="color: #002200;">&#125;</span></pre></td></tr></table></div>

<p>你在这里做了 <code>tableView(<em>:numberOfRowsInSection:)</em></code> 和 <code>tableView(:cellForRowAtIndexPath:)</code> 相同的判断, 不过现在，你给详情页提供了合适的糖果对象当你执行segue的时候。</p><br><p>此时编译并允许程序，看看导航到正确的详情页是多少轻松，无论是从主界面还是搜索页面。 </p><br><div align="center"><img src="http://www.raywenderlich.com/wp-content/uploads/2015/09/CandySearch-DetailView-281x500.png" width="281" height="500" class="aligncenter size-large wp-image-114436" srcset="https://cdn2.raywenderlich.com/wp-content/uploads/2015/09/CandySearch-DetailView-281x500.png 281w, https://cdn2.raywenderlich.com/wp-content/uploads/2015/09/CandySearch-DetailView-180x320.png 180w, https://cdn2.raywenderlich.com/wp-content/uploads/2015/09/CandySearch-DetailView.png 750w" sizes="(max-width: 281px) 100vw, 281px"></div><br><h2>创建一个 Scope Bar 来过滤结果</h2><br><p>如果你想提供给用户其他的方式来过滤结果, 你可以添加一个 <em>Scope Bar</em> 结合你的搜索条通过分类来过滤项目。 这些分类是你在创建糖果数组时指定给 <code>Candy</code> 对象的: <em>Chocolate</em>, <em>Hard</em>, and <em>其他</em> 。</p><br><p>首先, 你要先在<code>MasterViewController</code>创建一个scope bar. 这个scope bar是个分段控件，可以通过特定范围来缩小搜索。 一个scope就是你定义的那样。 这里他是一个糖果的分类, 不过scopes也可以是类型, 范围, 或者其他完全不同的东西。</p><br><p>使用scope bar和实现一个额外的代理方法一样容易。</p><br><p>在 <em>MasterViewController.swift</em>, 你要添加另一个扩展，需要遵守 <code>UISearchBarDelegate</code>协议. 在 <code>UISearchResultsUpdating</code> 后面添加扩展方法:</p>

<div class="wp_codebox"><table><tr id="p11377211"><td class="code" id="p113772code11"><pre class="swift" style="font-family:monospace;">extension MasterViewController<span style="color: #002200;">:</span> <span style="color: #2a6f76;">UISearchBarDelegate</span> <span style="color: #002200;">&#123;</span><br>  <span style="color: #a61390;">func</span> searchBar<span style="color: #002200;">&#40;</span>searchBar<span style="color: #002200;">:</span> <span style="color: #400080;">UISearchBar</span>, selectedScopeButtonIndexDidChange selectedScope<span style="color: #002200;">:</span> <span style="color: #a61390;">Int</span><span style="color: #002200;">&#41;</span> <span style="color: #002200;">&#123;</span><br>    filterContentForSearchText<span style="color: #002200;">&#40;</span>searchBar.text<span style="color: #002200;">!</span>, scope<span style="color: #002200;">:</span> searchBar.scopeButtonTitles<span style="color: #002200;">!</span><span style="color: #002200;">&#91;</span>selectedScope<span style="color: #002200;">&#93;</span><span style="color: #002200;">&#41;</span><br>  <span style="color: #002200;">&#125;</span><br><span style="color: #002200;">&#125;</span></pre></td></tr></table></div>

<p>这个代理方法在用户切换scope时候调用. 当方法执行时, 你想要重做过滤, 就要调用<code>filterContentForSearchText(<em>:scope:)</em></code> 用新的scope。</p><br><p>现在修改 <code>filterContentForSearchText(:scope:)</code> 来获取提供给账户的scope:</p>

<div class="wp_codebox"><table><tr id="p11377212"><td class="code" id="p113772code12"><pre class="swift" style="font-family:monospace;"><span style="color: #a61390;">func</span> filterContentForSearchText<span style="color: #002200;">&#40;</span>searchText<span style="color: #002200;">:</span> <span style="color: #a61390;">String</span>, scope<span style="color: #002200;">:</span> <span style="color: #a61390;">String</span> <span style="color: #002200;">=</span> <span style="color: #bf1d1a;">&quot;All&quot;</span><span style="color: #002200;">&#41;</span> <span style="color: #002200;">&#123;</span><br>  filteredCandies <span style="color: #002200;">=</span> candies.<span style="color: #a61390;">filter</span> <span style="color: #002200;">&#123;</span> candy <span style="color: #a61390;">in</span><br>    <span style="color: #a61390;">let</span> categoryMatch <span style="color: #002200;">=</span> <span style="color: #002200;">&#40;</span>scope <span style="color: #002200;">==</span> <span style="color: #bf1d1a;">&quot;All&quot;</span><span style="color: #002200;">&#41;</span> || <span style="color: #002200;">&#40;</span>candy.category <span style="color: #002200;">==</span> scope<span style="color: #002200;">&#41;</span><br>    <span style="color: #a61390;">return</span>  categoryMatch <span style="color: #002200;">&amp;&amp;</span> candy.name.lowercaseString.containsString<span style="color: #002200;">&#40;</span>searchText.lowercaseString<span style="color: #002200;">&#41;</span><br>  <span style="color: #002200;">&#125;</span><br>&nbsp;<br>  tableView.reloadData<span style="color: #002200;">&#40;</span><span style="color: #002200;">&#41;</span><br><span style="color: #002200;">&#125;</span></pre></td></tr></table></div>

<p>这个方法判断提供的scope是 &#8220;All&#8221; 还是匹配糖果的分类。 只有这样测试糖果名才知道是否将它加入 <code>filteredCandies</code>.</p><br><p>你快搞定了, 不过scope过滤机制还不能完全工作。你需要修改 <code>updateSearchResultsForSearchController(_:)</code> , 在第一个类扩展方法中，你用来传递当前选择的scope的:</p>

<div class="wp_codebox"><table><tr id="p11377213"><td class="code" id="p113772code13"><pre class="swift" style="font-family:monospace;"><span style="color: #a61390;">func</span> updateSearchResultsForSearchController<span style="color: #002200;">&#40;</span>searchController<span style="color: #002200;">:</span> UISearchController<span style="color: #002200;">&#41;</span> <span style="color: #002200;">&#123;</span><br>  <span style="color: #a61390;">let</span> searchBar <span style="color: #002200;">=</span> searchController.searchBar<br>  <span style="color: #a61390;">let</span> scope <span style="color: #002200;">=</span> searchBar.scopeButtonTitles<span style="color: #002200;">!</span><span style="color: #002200;">&#91;</span>searchBar.selectedScopeButtonIndex<span style="color: #002200;">&#93;</span><br>  filterContentForSearchText<span style="color: #002200;">&#40;</span>searchController.searchBar.text<span style="color: #002200;">!</span>, scope<span style="color: #002200;">:</span> scope<span style="color: #002200;">&#41;</span><br><span style="color: #002200;">&#125;</span></pre></td></tr></table></div>

<p>还剩个问题, 用户还看不到scope bar ! 来添加scope bar, 导航到 <em>MasterViewController.swift</em>, 在<code>viewDidLoad()</code>创建搜索控制器之后, 添加下面的代码:</p>

<div class="wp_codebox"><table><tr id="p11377214"><td class="code" id="p113772code14"><pre class="swift" style="font-family:monospace;">searchController.searchBar.scopeButtonTitles <span style="color: #002200;">=</span> <span style="color: #002200;">&#91;</span><span style="color: #bf1d1a;">&quot;All&quot;</span>, <span style="color: #bf1d1a;">&quot;Chocolate&quot;</span>, <span style="color: #bf1d1a;">&quot;Hard&quot;</span>, <span style="color: #bf1d1a;">&quot;Other&quot;</span><span style="color: #002200;">&#93;</span><br>searchController.searchBar.delegate <span style="color: #002200;">=</span> <span style="color: #a61390;">self</span></pre></td></tr></table></div>

<p></p><p>这个会在搜索条下面添加一个scope bar, 并且带有你指定的糖果分类。 同时包含用来忽略糖果分类的 <em>&#8220;All&#8221;</em> 。</p><p></p>
<p></p><p>现在, 当你输入的时候, 选择的scope按钮会和搜索文字一起使用。 </p><p></p>
<p></p><p>编译运行程序。 试着输入一些搜索文字, 同时改变scope。</p><p></p>
<div align="center"><img src="http://www.raywenderlich.com/wp-content/uploads/2015/09/UISearchController-Filter-with-Scope-281x500.png" width="281" height="500" class="aligncenter size-large wp-image-113863" srcset="https://cdn2.raywenderlich.com/wp-content/uploads/2015/09/UISearchController-Filter-with-Scope-281x500.png 281w, https://cdn2.raywenderlich.com/wp-content/uploads/2015/09/UISearchController-Filter-with-Scope-180x320.png 180w, https://cdn2.raywenderlich.com/wp-content/uploads/2015/09/UISearchController-Filter-with-Scope.png 750w" sizes="(max-width: 281px) 100vw, 281px"></div><br><p>输入 &#8220;caramel&#8221; scope 设置为 All。它出现在列表里, 如果你把scope换成Chocolate, &#8220;caramel&#8221; 消失了。 因为它不是巧克力。</p><br><h2>从这里去哪里呢?</h2><br><p>恭喜 &#8211; 你现在有了一个可以直接在主列表搜索的程序。 这里是 <a href="http://www.raywenderlich.com/wp-content/uploads/2015/09/CandySearch.zip" target="_blank" rel="external">可下载的简单工程</a> 含有上面所有的代码。</p><br><p>列表视图在各种程序里运用, 提供搜索选项是个好的触摸功能。 <code>UISearchBar</code> 和 <code>UISearchController</code>, iOS 提供了大部分的功能，你没有理由不用这个功能。 在大量列表中执行搜索是用户希望含有的功能; 一旦他们发现没有这个功能，他们会不高兴的。</p><br><div align="center"><img src="http://www.raywenderlich.com/wp-content/uploads/2012/07/nosearchfunction.jpg" width="400" height="361" class="size-full wp-image-19061" srcset="https://cdn2.raywenderlich.com/wp-content/uploads/2012/07/nosearchfunction.jpg 400w, https://cdn2.raywenderlich.com/wp-content/uploads/2012/07/nosearchfunction-250x225.jpg 250w, https://cdn2.raywenderlich.com/wp-content/uploads/2012/07/nosearchfunction-354x320.jpg 354w" sizes="(max-width: 400px) 100vw, 400px"></div>



        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">


</div>




<div class="comments-count">
	
</div>

</footer>


    </article>






   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2016/09/08/项目结束后的一些思考/" title="项目结束后的一些思考" itemprop="url">项目结束后的一些思考</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="跳跳魔王" target="_blank" itemprop="author">跳跳魔王</a>
		
  <p class="article-time">
    <time datetime="2016-09-08T08:42:51.000Z" itemprop="datePublished"> 发表于 2016-09-08</time>
    
  </p>
</header>
    <div class="article-content">
        
        <blockquote>
<p>为什么项目又延期了？ ——–来自市场的愤怒 </p>
</blockquote>
<p>为什么项目又延期了呢？</p>
<div style="text-align:center"><br><img src="http://img306.ph.126.net/Xk7NwVjqPUtaYlY6u2m2GQ==/3852829481215481010.jpg"><br></div>

<p>从项目立项到发布，一般项目的生命周期都是如上图所示，任何一个环节出现问题，都会增加工时的消耗</p>
<p>开源中国社区 <a href="http://www.oschina.net/question/565065_86309" title="百度" target="_blank" rel="external">软件开发流程</a> 说的很详细了，我只说说自己的一些看法和见解。</p>
<h1 id="关于知识的储备"><a href="#关于知识的储备" class="headerlink" title="关于知识的储备"></a>关于知识的储备</h1><div><br><p>笔者曾经参与多个iOS项目的开发，大大小小的项目都经历，实话说，极少有项目可以按时交付，即使连最基本的问题清零都做不到，基本都需要加班加点，到最后还是会遗留一些解决不了的问题。<br></p><br><p>新人越多的项目越容易出问题，当新人逐渐变成老司机的时候，无论是代码质量还是项目进度都变的靠谱多了。现代开发虽然引入了很多提高工作效率的工具和方法，但是人的能力还是占主导地位，人的知识储备在此就显得尤为重要了。<br></p><br><p>对新人的培养必须区别于学校，培养其主动学习能力才是进步之石，作为领导或者开发组长，应该根据员工的特点为其引路，创造学习的环境和条件，而不是将任务分配完了就不管了。在我经历的项目中，发现大多数的新人做了很多重复性的工作，在很长的时期里机械的做事，根本没有机会成长，他们现在或者变成老油条或者继续做着简单的工作，在新的毕业生涌入的潮流中，彻底的沉下去了。<br><br></p></div>

<div style="text-align:center"><br><img src="http://photocdn.sohu.com/20150811/mp26839099_1439275236239_1_th.jpeg" width="280" height="300"><br></div>

<h1 id="关于责任心"><a href="#关于责任心" class="headerlink" title="关于责任心"></a>关于责任心</h1><div><br><p>责任心这个东西应该是个后天的东西，因此在新人面试的时候，怎么在短短几十分钟内辨别面试者的责任心，是需要经验和一些运气的。如果等到新人进组和接手开发任务的时候，再去辨别就有点晚了。<br></p><br><p>有责任心的员工自主性相对较强，对自己的工作进度和质量都有着高度的要求，轻易不会表现沮丧和得过且过，接手的功能和任务都会认真对待，即使能力一时不足，也会通过不断的学习和填坑来完成，并不断总结，最终他开发的功能一般都会有个比较好的结果。<br></p><br></div>

<h1 id="关于工作方式"><a href="#关于工作方式" class="headerlink" title="关于工作方式"></a>关于工作方式</h1><div><br><p>成功者都有一套自己的工作方式，普通人也有自己的工作方式，不同之处是高效和低效的区别。软件开发是体力和脑力劳动的结合，其中脑力劳动占据了主导地位，善于用脑的工程师是一般都掌握一套可以提高工作效率的工具和工作方式。<br></p><br><p>我个人认为提高工作效率的方式就是总结归纳改进，但是至于如何总结归纳改进则看情况而定。在我经历过的大大小小数十个项目中，多数的工程师变的平庸了，走向卓越的工程师非常稀少。这些人现在遍布在不同的公司，担任着重要的职务，甚至有些人已经创业成功，晋级到了富人阶层。<br></p><br></div>

<div style="text-align:center"><br><img src="http://img5.imgtn.bdimg.com/it/u=2981119672,2990184737&fm=21&gp=0.jpg" width="400" height="300"><br></div>

<h1 id="关于总结"><a href="#关于总结" class="headerlink" title="关于总结"></a>关于总结</h1><div><br><p>项目总结很重要也很必要，至少我是这么认为的。很多重复发生的错误和事故都是因为没及时总结造成的，这简直是犯罪。作为项目管理者，不能指望所有的工程师都会及时总结经验，汲取教训，更不会主动去帮别人总结。<br><br>人的惰性是天性，勤奋的人都是养成习惯才勤奋的，作为管理者要让工程师养成总结的习惯，而不是让他们自己去发挥主观能动性。参与总结的人越多，工程师越是放松，越能说出真实的想法，并付诸行动。<br><br>我开总结会，一般从三个方面来进行，一是自身的不足和改进，二是项目的不足和改进，三是公司提供的资源是否到位。一般来说，前面两点大部分的工程师都能讲出几条不足和改进意见，唯独第三条不知为什么要考虑这个因素。我的观点是，项目不是独立的，研发和测试只是产品生命周期的一个阶段，公司的很多部门都会对研发工作产生影响，很多工程师看不到这点。学会与各个部门打交道，不止是领导层的工作，也是工程师需要具备的能力。<br></p><br></div>

        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">


</div>




<div class="comments-count">
	
</div>

</footer>


    </article>







</div>
      <div class="openaside"><a class="navbutton" href="#" title="显示侧边栏"></a></div>

<div id="asidepart">
<div class="closeaside"><a class="closebutton" href="#" title="隐藏侧边栏"></a></div>
<aside class="clearfix">

  


  

  

  <div class="linkslist">
  <p class="asidetitle">友情链接</p>
    <ul>
        
          <li>
            
            	<a href="https://coderq.com" target="_blank" title="一个面向程序员交流分享的新一代社区">码农圈</a>
            
          </li>
        
          <li>
            
            	<a href="http://wuchong.me" target="_blank" title="Jark&#39;s Blog">Jark&#39;s Blog</a>
            
          </li>
        
    </ul>
</div>

  


  <div class="rsspart">
	<a href="/atom.xml" target="_blank" title="rss">RSS 订阅</a>
</div>

  <div class="weiboshow">
  <p class="asidetitle">新浪微博</p>
    <iframe width="100%" height="119" class="share_self"  frameborder="0" scrolling="no" src="http://widget.weibo.com/weiboshow/index.php?language=&width=0&height=119&fansRow=2&ptype=1&speed=0&skin=9&isTitle=1&noborder=1&isWeibo=0&isFans=0&uid=null&verifier=b3593ceb&dpc=1"></iframe>
</div>


</aside>
</div>
    </div>
    <footer><div id="footer" >
	
	<div class="line">
		<span></span>
		<div class="author"></div>
	</div>
	
	
	<section class="info">
		<p> 大家好,我是熙健的iOS工程师. <br/>
			这是我的博客,努力奋斗.</p>
	</section>
	 
	<div class="social-font" class="clearfix">
		
		<a href="http://weibo.com/2176287895" target="_blank" class="icon-weibo" title="微博"></a>
		
		
		
		
		
		
		
		
		
		
	</div>
			
		

		<p class="copyright">
		Powered by <a href="http://hexo.io" target="_blank" title="hexo">hexo</a> and Theme by <a href="https://github.com/wuchong/jacman" target="_blank" title="Jacman">Jacman</a> © 2016 
		
		<a href="/about" target="_blank" title="跳跳魔王">跳跳魔王</a>
		
		
		</p>
</div>
</footer>
    <script src="/js/jquery-2.0.3.min.js"></script>
<script src="/js/jquery.imagesloaded.min.js"></script>
<script src="/js/gallery.js"></script>
<script src="/js/jquery.qrcode-0.12.0.min.js"></script>

<script type="text/javascript">
$(document).ready(function(){ 
  $('.navbar').click(function(){
    $('header nav').toggleClass('shownav');
  });
  var myWidth = 0;
  function getSize(){
    if( typeof( window.innerWidth ) == 'number' ) {
      myWidth = window.innerWidth;
    } else if( document.documentElement && document.documentElement.clientWidth) {
      myWidth = document.documentElement.clientWidth;
    };
  };
  var m = $('#main'),
      a = $('#asidepart'),
      c = $('.closeaside'),
      o = $('.openaside');
  c.click(function(){
    a.addClass('fadeOut').css('display', 'none');
    o.css('display', 'block').addClass('fadeIn');
    m.addClass('moveMain');
  });
  o.click(function(){
    o.css('display', 'none').removeClass('beforeFadeIn');
    a.css('display', 'block').removeClass('fadeOut').addClass('fadeIn');      
    m.removeClass('moveMain');
  });
  $(window).scroll(function(){
    o.css("top",Math.max(80,260-$(this).scrollTop()));
  });
  
  $(window).resize(function(){
    getSize(); 
    if (myWidth >= 1024) {
      $('header nav').removeClass('shownav');
    }else{
      m.removeClass('moveMain');
      a.css('display', 'block').removeClass('fadeOut');
      o.css('display', 'none');
        
    }
  });
});
</script>










<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
$(document).ready(function(){ 
  $('.article-content').each(function(i){
    $(this).find('img').each(function(){
      if ($(this).parent().hasClass('fancybox')) return;
      var alt = this.alt;
      if (alt) $(this).after('<span class="caption">' + alt + '</span>');
      $(this).wrap('<a href="' + this.src + '" title="' + alt + '" class="fancybox"></a>');
    });
    $(this).find('.fancybox').each(function(){
      $(this).attr('rel', 'article' + i);
    });
  });
  if($.fancybox){
    $('.fancybox').fancybox();
  }
}); 
</script>



<!-- Analytics Begin -->



<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "//hm.baidu.com/hm.js?e6d1f421bbc9962127a50488f9ed37d1";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>



<!-- Analytics End -->

<!-- Totop Begin -->

	<div id="totop">
	<a title="返回顶部"><img src="/img/scrollup.png"/></a>
	</div>
	<script src="/js/totop.js"></script>

<!-- Totop End -->

<!-- MathJax Begin -->
<!-- mathjax config similar to math.stackexchange -->


<!-- MathJax End -->

<!-- Tiny_search Begin -->

<!-- Tiny_search End -->

  </body>
 </html>
